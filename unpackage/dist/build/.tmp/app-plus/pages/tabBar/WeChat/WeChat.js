(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/tabBar/WeChat/WeChat"],{"0f10":function(e,t,n){"use strict";n.r(t);var o=n("5995"),i=n("bb26");for(var a in i)"default"!==a&&function(e){n.d(t,e,function(){return i[e]})}(a);n("5dec");var r=n("2877"),s=Object(r["a"])(i["default"],o["a"],o["b"],!1,null,null,null);t["default"]=s.exports},"15e5":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=s(n("e3ba")),i=s(n("b972")),a=s(n("79ee")),r=n("2f62");function s(e){return e&&e.__esModule?e:{default:e}}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){u(e,t,n[t])})}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l={data:function(){return{len:0,startX:0,moveEndX:0,valueX:0,alertarray:{show:!1,msg:""},wxexist:!1,sDialog:{message:"您可能还没有安装微信客户端，请前往安装，或者使用账户和密码登录"},Auth:{OpenId:"",UninId:""},Userform:{nickName:"",avatarUrl:"",UserId:"",UserPh:"000000",UserTime:"",Userinfos:"",Cardinfo:""}}},components:{alerts:o.default,simpleDialog:i.default,simpleLoading:a.default},onLoad:function(e){},methods:c({},(0,r.mapMutations)(["wxlogin"]),{touchstart:function(e){e.preventDefault(),this.startX=e.touches[0].pageX},touchmove:function(t){t.preventDefault(),this.moveEndX=t.touches[0].pageX,this.valueX=this.moveEndX-this.startX,this.valueX>=80&&e.navigateBack({delta:1,animationType:"pop-in",animationDuration:200})},getwxexist:function(){return this.wxexist},confirmButton:function(){console.log("Dialog 确定按钮点击"),plus.runtime.openURL("https://mobile.baidu.com/item?docid=25861398&source=aladdin%40wise_app_23%40title&ala=strong%4025861398%402786482313%40jp1.baidu.com%40title%40%E5%BE%AE%E4%BF%A1&ala=app_mobile_rich%402052%40s%40%E5%BE%AE%E4%BF%A1%E4%B8%8B%E8%BD%BD%4010823306764847032937%40title&from=1022306m")},cancelButton:function(){console.log("Dialog 取消按钮点击")},openloading:function(){this.$refs.simpleLoading.show({image:"../../../static/app-plus/tus.png",text:"登陆中..."})},closeloading:function(){this.$refs.simpleLoading.hide()},GetDatas:function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1,o=e.getDate();n=n<10?"0"+n:n,o=o<10?"0"+o:o,this.Userform.UserTime=t+"-"+n+"-"+o},AjaxUserInfo:function(){var t=this,n=this,o='{method:"GetUserInfo",user_id:"'.concat(this.Userform.UserId,'"}');this.$api.ReagisterPhone(o).then(function(o){console.log(JSON.stringify(o)),t.Userform.Userinfos=JSON.parse(o.data.user_info)[0];var i='{method:"GetUserInfo",user_id:"'.concat(n.Userform.UserId,'"}');n.$api.ReagisterPhone(i).then(function(o){console.log(JSON.parse(o.data.user_info)[0].M0001_PHONE);var i=/^[1][3,4,5,7,8][0-9]{9}$/;i.test(JSON.parse(o.data.user_info)[0].M0001_PHONE)?(n.Userform.UserPh=JSON.parse(o.data.user_info)[0].M0001_PHONE,console.log(n.Userform.UserPh)):(n.Userform.UserPh="000000",console.log(n.Userform));var a='{method:"GetUserCard",user_id:"'.concat(t.Userform.UserId,'"}');t.$api.ReagisterPhone(a).then(function(t){console.log(JSON.stringify(t)),0==t.data.result?n.Userform.Cardinfo="no":n.Userform.Cardinfo=JSON.parse(t.data.data)[0],n.GetDatas(),console.log(JSON.stringify(n.Userform)),n.wxlogin(n.Userform),n.openloading(),setTimeout(function(){n.closeloading(),e.showToast({title:"登录成功",duration:1e3,icon:"none",success:function(){e.switchTab({url:"/pages/tabBar/personCenter/personCenter"})}})},1e3)})})})},thirdLogin:function(){var t=this;e.showToast({title:"正在授权中,请稍后...",duration:2e3,icon:"none"}),e.getProvider({service:"oauth",success:function(n){console.log(JSON.stringify(n)),~n.provider.indexOf("weixin")&&e.login({provider:"weixin",success:function(n){console.log(JSON.stringify(n)),t.wxexist=!0,console.log(t.wxexist),e.hideToast(),e.getUserInfo({provider:"weixin",success:function(e){console.log("-------获取微信用户所有-----"),t.Auth.OpenId=e.userInfo.openId,t.Auth.UninId=e.userInfo.unionId;var n='{method:"AuthLogin",openId:"'.concat(t.Auth.OpenId,'",uninid:"').concat(t.Auth.UninId,'"}');t.$api.AuthLogin(n).then(function(n){console.log(n.data.user_id),t.Userform.UserId=n.data.user_id,t.Userform.avatarUrl=e.userInfo.avatarUrl,t.Userform.nickName=e.userInfo.nickName,t.AjaxUserInfo()})}})},fail:function(e){if(console.log(JSON.stringify(e)),-8==e.code){var n=t.getwxexist();console.log(n),n||t.$refs.simpleDialog2.confirm({title:"提示！",message:t.sDialog.message})}},complete:function(){}})}})}})};t.default=l}).call(this,n("6e42")["default"])},"45ff":function(e,t,n){},5995:function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",{attrs:{id:"conent",eventid:"6f4ac843-2"},on:{touchstart:e.touchstart,touchmove:e.touchmove}},[e._m(0),n("view",{staticClass:"conent-middle"},[e._v("同意将微信账户的信息授权给当前用户")]),n("button",{staticClass:"weibtn",attrs:{eventid:"6f4ac843-0"},on:{click:e.thirdLogin}},[e._v("确认授权")]),n("alerts",{attrs:{show:e.alertarray.show,msg:e.alertarray.msg,mpcomid:"6f4ac843-0"}}),n("simpleDialog",{ref:"simpleDialog2",attrs:{title:e.sDialog.title,message:e.sDialog.message,eventid:"6f4ac843-1",mpcomid:"6f4ac843-1"},on:{confirmButton:e.confirmButton,cancelButton:e.cancelButton}}),n("simpleLoading",{ref:"simpleLoading",attrs:{mpcomid:"6f4ac843-2"}})],1)},i=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("view",{staticClass:"conent-top"},[n("image",{attrs:{src:"../../../static/app-plus/logo.png",mode:""}}),n("image",{attrs:{src:"../../../static/login/wejian.png",mode:""}}),n("image",{attrs:{src:"../../../static/login/wechat.png",mode:""}})])}];n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i})},"5dec":function(e,t,n){"use strict";var o=n("45ff"),i=n.n(o);i.a},bb26:function(e,t,n){"use strict";n.r(t);var o=n("15e5"),i=n.n(o);for(var a in o)"default"!==a&&function(e){n.d(t,e,function(){return o[e]})}(a);t["default"]=i.a},f102:function(e,t,n){"use strict";n("fa0a");var o=a(n("b0ce")),i=a(n("0f10"));function a(e){return e&&e.__esModule?e:{default:e}}Page((0,o.default)(i.default))}},[["f102","common/runtime","common/vendor"]]]);