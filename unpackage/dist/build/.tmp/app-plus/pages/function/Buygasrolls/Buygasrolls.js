(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/function/Buygasrolls/Buygasrolls"],{"194e":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=l(i("8ccb")),a=l(i("e3ba")),o=l(i("79ee")),n=i("2f62"),c=l(i("3a78")),r=l(i("f227"));function l(t){return t&&t.__esModule?t:{default:t}}var u={data:function(){return{couponlist:[],len:0,startX:0,moveEndX:0,valueX:0,array:["100","200","500","800","1000"],index:1,col:"#ccc",pricetext:"请选择金额",checkchecke:!1,vershow:!0,vervisit:"none",Payamin:!1,diskif:!1,payone:!0,paytwo:!1,weixinimage:!0,balanceimage:!1,money:"0.00",Promptinfo:"",payreplacetext:"微信",alertarray:{show:!1,msg:""},BuyMoney:"",CountBuyMoney:0,moneyno:!1,gasrolls:!0,QRcode:!1,val:"",size:400,unit:"upx",background:"white",foreground:"black",pdground:"#32dbc6",icon:"../../../static/login/tus.png",iconsize:40,lv:3,onval:!1,loadMake:!0,src:"",Buyindex:0,BuyNumber:"0.00",BuyCountNum:0,dischecked:!0,radioImg:!1,Settimeout:"",ceshiindex:0,CrolssQUan:!0,BuyClear:!1}},computed:(0,n.mapState)(["UserInfo"]),onLoad:function(){var t=this;t.val="id=2,name=胡松波",this.GetBuyCountMoney()},components:{uniKeyboard:s.default,alerts:a.default,simpleLoading:o.default,tkiQrcode:c.default,coupon:r.default},filters:{filmoney:function(t){return""==t&&(t="0.00"),t}},onNavigationBarButtonTap:function(e){t.navigateTo({url:"/pages/function/coderecord/coderecord",animationType:"pop-in",animationDuration:200})},watch:{BuyMoney:function(t,e){this.CountBuyMoney=t,console.log(this.CountBuyMoney)},ceshiindex:function(e,i){var s=this;console.log(e),e>=5&&(clearTimeout(this.Settimeout),setTimeout(function(){t.showToast({title:"二维码已被核销",duration:1e3,icon:"none",success:function(){s.gasrolls=!s.gasrolls,s.QRcode=!s.QRcode}})},1e3))}},methods:{GetUserMoney:function(){var t=this;this.UserInfo.userid="3052109275300000002";var e='{method:"GetUserMoneyInfo",user_id:"'.concat(this.UserInfo.userid,'"}');this.$api.ReagisterPhone(e).then(function(e){if(console.log(e),0!=e.data.result||"暂无用户余额信息"!=e.data.message){if(1==e.data.result){var i=JSON.parse(e.data.data_score)[0];t.money=i.MONEY}}else t.money="0.00"})},Monitoringcode:function(){var t=this;this.Settimeout=setInterval(function(){t.ceshiindex++},1e3)},GetBuyCountMoney:function(){var t=this,e=this,i='{method:"GetUserGift",user_id:"'.concat(this.UserInfo.userid,'"}');this.$api.ReagisterPhone(i).then(function(i){if(0==i.data.result)return console.log(i.data.message),void(e.CrolssQUan=!1);e.CrolssQUan=!0;var s=JSON.parse(i.data.data);t.couponlist=[],s.forEach(function(e){var i=e.使用日期,s=i.slice(0,4),a=i.slice(4,6),o=i.slice(6,8);e.使用日期=s+"/"+a+"/"+o,e.price=e.礼品价格,e.Explain=e.礼品说明,e.name=e.礼品名称,e.Term=e.有效期,"未使用"==e.礼品状态&&t.couponlist.push(e)}),0==t.couponlist.length&&(t.CrolssQUan=!1),t.couponlist.forEach(function(t){e.BuyCountNum=parseFloat(e.BuyCountNum)+parseFloat(t.price),console.log(t.price)}),console.log(e.BuyCountNum),console.log(t.couponlist)})},checkchecked:function(){console.log(this.BuyMoney),""!=this.BuyMoney&&null!=this.BuyMoney?parseFloat(this.BuyCountNum)>=parseFloat(this.BuyMoney)?t.showToast({title:"不可以选择此加油券，优惠券总金额已大于充值金额",duration:1e3,icon:"none"}):(this.checkchecke=!this.checkchecke,this.checkchecke):t.showToast({title:"请输入充值金额",duration:1e3,icon:"none"})},touchstart:function(t){t.preventDefault(),this.startX=t.touches[0].pageX},touchmove:function(e){return e.preventDefault(),this.moveEndX=e.touches[0].pageX,this.valueX=this.moveEndX-this.startX,this.valueX>=80?void t.navigateBack({delta:1,animationType:"pop-in",animationDuration:200}):void this.valueX},bindPickerChange:function(t){console.log(t.target),this.pricetext=this.array[t.target.value]+".00",this.col="black"},Settlement:function(){"请登录"!=this.UserInfo.userphone?""==this.BuyMoney||this.BuyMoney<=0?t.showToast({title:"请输入正确的支付数值",duration:1e3,icon:"none"}):(this.GetUserMoney(),this.payone=!0,this.diskif=!0,this.Payamin=!0):t.showToast({title:"您好还没有登录，请先登录再充值",duration:1e3,icon:"none"})},Replacemode:function(){(parseFloat(this.money)<=0||parseFloat(this.money)<parseFloat(this.BuyMoney))&&(this.moneyno=!0),this.payone=!1,this.paytwo=!0},Optionbalance:function(){var t=this;if(console.log(parseFloat(this.money)),console.log(parseFloat(this.BuyMoney)),parseFloat(this.money)<=0||parseFloat(this.money)<parseFloat(this.BuyMoney))return this.Promptinfo="余额不足，请选择微信支付方式进行支付",this.vervisit="block",this.veramin=!0,void setTimeout(function(){t.vervisit="none",t.veramin=!1},1500);this.payone=!0,this.paytwo=!1,this.payreplacetext="账户余额",this.weixinimage=!1,this.balanceimage=!0},weixinoption:function(){this.payone=!0,this.paytwo=!1,this.payreplacetext="微信",this.weixinimage=!0,this.balanceimage=!1,this.vervisit="none",this.veramin=!1},backpayone:function(){this.payone=!0,this.paytwo=!1,this.vervisit="none",this.veramin=!1},closepay:function(){this.weixinoption(),this.diskif=!1,this.Payamin=!1},done:function(e){var i=this,s=this;return"error"==e?(this.alertarray.show=!0,this.alertarray.msg="支付密码不正确",setTimeout(function(){i.alertarray.show=!1},1e3),!1):(this.closepay(),this.$refs.keyboard.hide(),this.$refs.simpleLoading.show({image:"../../../static/app-plus/tus.png",text:"支付中..."}),setTimeout(function(){i.$refs.simpleLoading.hide(),t.showToast({title:"支付成功",duration:1e3,icon:"none",success:function(){s.gasrolls=!s.gasrolls,s.QRcode=!0,s.BuyMoney="",s.CountBuyMoney="",s.checkchecke=!1,s.couponlist.forEach(function(t){t.state=1}),s.Buyindex=0,s.BuyNumber=0,s.Monitoringcode()}})},2e3),console.log("支付成功"),!0)},GetBuy:function(t){if(console.log(t),2==t.state)return this.Buyindex++,this.BuyNumber=parseFloat(this.BuyNumber)+parseFloat(t.money),this.CountBuyMoney=parseFloat(this.CountBuyMoney)-parseFloat(t.money),void console.log("aaaaaaaaa"+this.CountBuyMoney);this.Buyindex--,this.BuyNumber=parseFloat(this.BuyNumber)-parseFloat(t.money),this.CountBuyMoney=parseFloat(this.CountBuyMoney)+parseFloat(t.money)},Changestate:function(){this.CountBuyMoney=this.BuyMoney,this.BuyClear=!this.BuyClear,this.checkchecke=!1,this.couponlist.forEach(function(t){t.state=1}),this.Buyindex=0,this.BuyNumber=0},confirmPwd:function(){if("微信"==this.payreplacetext)return this.payone=!1,this.closepay(),void t.getProvider({service:"payment",success:function(e){console.log(e.provider),~e.provider.indexOf("wxpay")&&t.requestPayment({provider:"wxpay",orderInfo:"orderInfo",success:function(t){console.log("success:"+JSON.stringify(t))},fail:function(t){console.log("fail:"+JSON.stringify(t))}})}});this.$refs.keyboard.show(),this.payone=!1,this.closepay()},sliderchange:function(t){this.size=t.detail.value},creatQrcode:function(){this.$refs.qrcode._makeCode()},saveQrcode:function(){this.$refs.qrcode._saveCode()},qrR:function(t){this.src=t},clearQrcode:function(){this.$refs.qrcode._clearCode(),this.val=""},ifQrcode:function(){this.ifShow=!this.ifShow}}};e.default=u}).call(this,i("6e42")["default"])},"1ff1":function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view",{staticClass:"content",attrs:{eventid:"02be2ee5-14"},on:{touchstart:t.touchstart,touchmove:t.touchmove}},[t.gasrolls?i("view",[i("view",{staticClass:"card"},[i("view",{staticClass:"card-content"},[i("view",{staticClass:"card-content-inner"},[i("p",{staticClass:"cz-czje"},[t._v("加油金额")]),i("p",{staticClass:"je",staticStyle:{"border-bottom":"1px solid #DDDDDD","margin-top":"1.7rem",display:"flex","flex-direction":"row"}},[i("span",{staticStyle:{"font-size":"0.8rem","font-weight":"normal",display:"flex","align-items":"center","padding-right":"10rpx"}},[t._v("￥")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.BuyMoney,expression:"BuyMoney"}],staticStyle:{"font-size":".9rem"},attrs:{type:"number",placeholder:"请输入加油金额",eventid:"02be2ee5-0"},domProps:{value:t.BuyMoney},on:{focus:t.Changestate,input:function(e){e.target.composing||(t.BuyMoney=e.target.value)}}})]),i("view",{staticClass:"container"}),i("p")],1)])]),t._m(0),i("view",{staticClass:"yhq-list-box"},[t.CrolssQUan?t._e():i("view",{staticClass:"card"},[t._m(1)]),t.CrolssQUan?i("view",{staticClass:"card"},[i("view",{staticClass:"yh-yhjts"},[i("view",{staticClass:"yhjts-img",staticStyle:{float:"left",clear:"both"}},[t._m(2),i("view",{staticStyle:{float:"right",width:"60%","text-align":"right",color:"red","font-weight":"bold"}},[t._v(t._s(t.couponlist.length)+"张券可用/共"+t._s(t.couponlist.length)+"张券")])]),i("view",{staticClass:"card-content"}),i("view",{staticClass:"coupon_box"},t._l(t.couponlist,function(e,s){return i("coupon",{key:s,attrs:{BuyClear:t.BuyClear,item:e,BuyCountNums:t.BuyCountNum,Buymoeny:t.CountBuyMoney,checked:t.checkchecke,types:"carts",theme:"#ff6c00",color:"#ffffff",eventid:"02be2ee5-1-"+s,mpcomid:"02be2ee5-0-"+s},on:{completed:t.GetBuy}})})),i("view",{staticClass:"card-footer"},[i("view",{staticClass:"radios",staticStyle:{display:"flex","align-items":"center"}},[i("view",{staticClass:"radioss",staticStyle:{width:"40rpx",height:"40rpx",border:"1px solid #ff9000","border-radius":"50%",position:"relative"},attrs:{eventid:"02be2ee5-2"},on:{click:t.checkchecked}},[t.checkchecke?i("image",{staticStyle:{position:"absolute",top:"0",left:"0",width:"40rpx",height:"40rpx"},attrs:{src:"../../../static/app-plus/radio.png"}}):t._e()]),i("span",{staticStyle:{position:"relative",top:"5rpx","margin-left":"20rpx"}},[t._v("全选")])]),i("view",{staticClass:"numbers"},[t._v("已选"),i("span",{staticClass:"selNum"},[t._v(t._s(t.Buyindex)+"张,可抵用")]),i("span",{staticClass:"selPrice"},[t._v(t._s(t.BuyNumber))]),t._v("元")])])])]):t._e()]),i("view",{staticClass:"Verification",class:{veramin:t.vershow},style:{display:t.vervisit}},[t._v(t._s(t.Promptinfo))]),i("view",{staticClass:"bar-tab"},[i("a",{staticClass:"tab-item",staticStyle:{"font-weight":"bold"}},[i("span",{staticStyle:{"font-size":"0.65rem",color:"#333"}},[t._v("应支付:")]),i("span",{staticStyle:{color:"#E4393C","font-size":"0.85rem"},attrs:{id:"total"}},[t._v("￥"+t._s(t._f("filmoney")(t.CountBuyMoney)))])]),i("a",{staticClass:"tab-item",attrs:{id:"cz",eventid:"02be2ee5-3"},on:{click:t.Settlement}},[t._v("结算")])]),t.diskif?i("view",{staticClass:"disk",attrs:{eventid:"02be2ee5-4"},on:{click:t.closepay}}):t._e(),t.diskif?i("view",{staticClass:"Payment",class:{Payaminate:t.Payamin}},[t.payone?i("view",[i("view",{staticClass:"pay-title"},[t._v("确认付款"),i("image",{attrs:{src:"../../../static/navIcon/close.png",eventid:"02be2ee5-5"},on:{click:t.closepay}})]),i("view",{staticClass:"pay-middle"},[t._v("￥"),i("span",[t._v(t._s(t.CountBuyMoney))])]),i("view",{staticClass:"pay-active",staticStyle:{"border-bottom":"1px solid #ECECEC"},attrs:{eventid:"02be2ee5-6"},on:{click:t.Replacemode}},[i("view",{staticClass:"pay-xz"},[i("span",{staticStyle:{color:"#ACACB4"}},[t._v("付款方式")]),i("view",{staticClass:"pay-next"},[i("span",{staticStyle:{height:"35px","line-height":"35px"}},[t._v(t._s(t.payreplacetext))]),i("image",{attrs:{src:"../../../static/navIcon/next.png",mode:""}})])])]),i("button",{staticClass:"paymentbtn",attrs:{type:"primary",eventid:"02be2ee5-7"},on:{tap:t.confirmPwd}},[t._v("立即付款")])],1):t._e(),t.paytwo?i("view",[i("view",{staticClass:"pay-title pay-titles"},[t._v("选择付款方式"),i("image",{attrs:{src:"../../../static/navIcon/back.png",mode:"",eventid:"02be2ee5-8"},on:{click:t.backpayone}})]),i("view",{staticClass:"pay-active",staticStyle:{"border-bottom":"1px solid #ECECEC"},attrs:{eventid:"02be2ee5-9"},on:{click:t.weixinoption}},[i("view",{staticClass:"pay-xz pay-xzs"},[t._m(3),t.weixinimage?i("image",{attrs:{src:"../../../static/personCenter/icon_ok.png"}}):t._e()])]),i("view",{staticClass:"pay-active",staticStyle:{"border-bottom":"1px solid #ECECEC"},attrs:{eventid:"02be2ee5-10"},on:{click:t.Optionbalance}},[i("view",{staticClass:"pay-xz pay-xzs"},[i("view",{staticClass:"pay-xzs"},[i("image",{attrs:{src:"../../../static/personCenter/balance.png",mode:""}}),i("span",{staticStyle:{color:"#ACACB4"}},[t._v("账户余额")]),i("span",{staticStyle:{color:"#ACACB4","margin-left":"20rpx"}},[t._v("(剩余:￥"+t._s(t.money)+")")]),t.moneyno?i("span",{staticStyle:{color:"#ACACB4","margin-left":"20rpx"}},[t._v("余额不足")]):t._e()]),t.balanceimage?i("image",{attrs:{src:"../../../static/personCenter/icon_ok.png"}}):t._e()])])]):t._e()]):t._e()]):t._e(),i("uni-keyboard",{ref:"keyboard",attrs:{CouponPrice:t.CountBuyMoney,eventid:"02be2ee5-11",mpcomid:"02be2ee5-1"},on:{completed:t.done}}),i("alerts",{attrs:{show:t.alertarray.show,msg:t.alertarray.msg,mpcomid:"02be2ee5-2"}}),i("simpleLoading",{ref:"simpleLoading",attrs:{mpcomid:"02be2ee5-3"}}),t.QRcode?i("view",{staticClass:"QRcode"},[i("view",{staticClass:"qrimg"},[i("tki-qrcode",{ref:"qrcode",attrs:{val:t.val,size:t.size,unit:t.unit,background:t.background,foreground:t.foreground,pdground:t.pdground,icon:t.icon,iconSize:t.iconsize,lv:t.lv,onval:t.onval,loadMake:t.loadMake,usingComponents:!0,eventid:"02be2ee5-12",mpcomid:"02be2ee5-4"},on:{result:t.qrR}})],1),i("view",{staticStyle:{"text-align":"center","margin-top":"20rpx"}},[t._v("请扫描此二维码")]),i("view",{staticClass:"btns",staticStyle:{display:"flex","justify-content":"center"}},[i("button",{staticStyle:{padding:"10rpx 20rpx",display:"flex","align-items":"center","margin-top":"20rpx",background:"rgb(50,219,198)",color:"white",border:"0"},attrs:{eventid:"02be2ee5-13"},on:{tap:t.saveQrcode}},[t._v("保存二维码")])],1)]):t._e()],1)},a=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view",{staticClass:"content-block-title"},[i("span",{staticStyle:{color:"#C8C7CC"}},[t._v("优惠券")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("view",{staticClass:"yh-yhjts",staticStyle:{display:"flex","flex-direction":"row"}},[s("view",{staticClass:"yhjts-img",staticStyle:{float:"left",clear:"both"}},[s("view",{staticClass:"yhjts-left",staticStyle:{width:"40%",float:"left",display:"flex","flex-direction":"row","align-items":"center"}},[s("img",{staticStyle:{height:"0.7rem",border:"0"},attrs:{src:i("d3c5"),alt:""}}),s("span",{staticStyle:{"margin-left":"20rpx","font-weight":"bold"}},[t._v("优惠券")])]),s("view",{staticStyle:{float:"right",width:"60%","text-align":"right",color:"red","font-weight":"bold"}},[t._v("无抵用券使用")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("view",{staticClass:"yhjts-left",staticStyle:{width:"40%",float:"left",display:"flex","flex-direction":"row","align-items":"center"}},[s("img",{staticStyle:{height:"0.7rem",border:"0"},attrs:{src:i("d3c5"),alt:""}}),s("span",{staticStyle:{"margin-left":"20rpx","font-weight":"bold"}},[t._v("优惠券")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view",{staticClass:"pay-xzs"},[i("image",{attrs:{src:"../../../static/personCenter/weixin.png",mode:""}}),i("span",{staticStyle:{color:"#ACACB4"}},[t._v("微信")]),i("span",{staticStyle:{color:"white",background:"#C0C0C0","margin-left":"20rpx","font-size":"0.6rem",padding:"4rpx"}},[t._v("推荐")])])}];i.d(e,"a",function(){return s}),i.d(e,"b",function(){return a})},7944:function(t,e,i){},8529:function(t,e,i){"use strict";var s=i("7944"),a=i.n(s);a.a},afc6:function(t,e,i){"use strict";i.r(e);var s=i("1ff1"),a=i("ce3a");for(var o in a)"default"!==o&&function(t){i.d(e,t,function(){return a[t]})}(o);i("8529");var n=i("2877"),c=Object(n["a"])(a["default"],s["a"],s["b"],!1,null,"ca2e7ffc",null);e["default"]=c.exports},ce3a:function(t,e,i){"use strict";i.r(e);var s=i("194e"),a=i.n(s);for(var o in s)"default"!==o&&function(t){i.d(e,t,function(){return s[t]})}(o);e["default"]=a.a},f7cc:function(t,e,i){"use strict";i("fa0a");var s=o(i("b0ce")),a=o(i("afc6"));function o(t){return t&&t.__esModule?t:{default:t}}Page((0,s.default)(a.default))}},[["f7cc","common/runtime","common/vendor"]]]);