(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/function/Buygasrolls/Buygasrolls"],{"2c48":function(e,t,o){"use strict";o.r(t);var n=o("8abe"),s=o.n(n);for(var i in n)"default"!==i&&function(e){o.d(t,e,function(){return n[e]})}(i);t["default"]=s.a},"4ec4":function(e,t,o){"use strict";var n=function(){var e=this,t=e.$createElement,n=(e._self._c,o("beda")),s=o("beda"),i=e._f("filmoney")(e.CountBuyMoney);e.$mp.data=Object.assign({},{$root:{m0:n,m1:s,f0:i}})},s=[];o.d(t,"a",function(){return n}),o.d(t,"b",function(){return s})},"53f6":function(e,t,o){"use strict";var n=o("56d0"),s=o.n(n);s.a},"56d0":function(e,t,o){},"88b6":function(e,t,o){"use strict";o.r(t);var n=o("4ec4"),s=o("2c48");for(var i in s)"default"!==i&&function(e){o.d(t,e,function(){return s[e]})}(i);o("53f6");var a=o("2877"),u=Object(a["a"])(s["default"],n["a"],n["b"],!1,null,"4d89f082",null);t["default"]=u.exports},"8abe":function(e,t,o){"use strict";(function(e,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=o("2f62"),i=function(){return o.e("components/uni-keyboard").then(o.bind(null,"93d1"))},a=function(){return o.e("components/loading/alert").then(o.bind(null,"818f"))},u=function(){return o.e("components/loading/dialog-loading").then(o.bind(null,"7213"))},r=function(){return Promise.all([o.e("common/vendor"),o.e("components/tki-qrcode/tki-qrcode")]).then(o.bind(null,"8484"))},c=function(){return o.e("components/coolc-coupon/coolc-coupon").then(o.bind(null,"602f"))},l={data:function(){return{couponlist:[],len:0,startX:0,moveEndX:0,valueX:0,array:["100","200","500","800","1000"],index:1,col:"#ccc",pricetext:"请选择金额",checkchecke:!1,vershow:!0,vervisit:"none",Payamin:!1,diskif:!1,payone:!0,paytwo:!1,weixinimage:!0,balanceimage:!1,yunshanfuimage:!1,money:"0.00",Promptinfo:"",payreplacetext:"微信",alertarray:{show:!1,msg:""},BuyMoney:"",CountBuyMoney:"0",moneyno:!1,gasrolls:!0,QRcode:!1,val:"",size:400,unit:"upx",background:"white",foreground:"black",pdground:"#32dbc6",icon:"../../../static/login/tus.png",iconsize:40,lv:3,onval:!1,loadMake:!0,src:"",Buyindex:0,BuyNumber:"0.00",BuyCountNum:0,dischecked:!0,radioImg:!1,Settimeout:"",ceshiindex:0,CrolssQUan:!0,BuyClear:!1}},computed:(0,s.mapState)(["UserInfo"]),onLoad:function(){var e=this;e.val="id=2,name=胡松波",this.GetBuyCountMoney()},components:{uniKeyboard:i,alerts:a,simpleLoading:u,tkiQrcode:r,coupon:c},filters:{filmoney:function(e){return""==e&&(e="0.00"),e}},onNavigationBarButtonTap:function(t){e.navigateTo({url:"/pages/function/coderecord/coderecord",animationType:"pop-in",animationDuration:200})},watch:{BuyMoney:function(e,t){this.CountBuyMoney=e,console.log(n(this.CountBuyMoney," at pages\\function\\Buygasrolls\\Buygasrolls.vue:288"))},ceshiindex:function(t,o){var s=this;console.log(n(t," at pages\\function\\Buygasrolls\\Buygasrolls.vue:292")),t>=5&&(clearTimeout(this.Settimeout),setTimeout(function(){e.showToast({title:"二维码已被核销",duration:1e3,icon:"none",success:function(){s.gasrolls=!s.gasrolls,s.QRcode=!s.QRcode}})},1e3))}},methods:{GetUserMoney:function(){var e=this;this.UserInfo.userid="3052109275300000002";var t='{method:"GetUserMoneyInfo",user_id:"'.concat(this.UserInfo.userid,'"}');this.$api.ReagisterPhone(t).then(function(t){if(console.log(n(t," at pages\\function\\Buygasrolls\\Buygasrolls.vue:315")),0!=t.data.result||"暂无用户余额信息"!=t.data.message){if(1==t.data.result){var o=JSON.parse(t.data.data_score)[0];e.money=o.MONEY}}else e.money="0.00"})},Monitoringcode:function(){var e=this;this.Settimeout=setInterval(function(){e.ceshiindex++},1e3)},GetBuyCountMoney:function(){var e=this,t=this,o='{method:"GetUserGift",user_id:"'.concat(this.UserInfo.userid,'"}');this.$api.ReagisterPhone(o).then(function(o){if(0==o.data.result)return console.log(n(o.data.message," at pages\\function\\Buygasrolls\\Buygasrolls.vue:339")),void(t.CrolssQUan=!1);t.CrolssQUan=!0;var s=JSON.parse(o.data.data);e.couponlist=[],s.forEach(function(t){var o=t.使用日期,n=o.slice(0,4),s=o.slice(4,6),i=o.slice(6,8);t.使用日期=n+"/"+s+"/"+i,t.price=t.礼品价格,t.Explain=t.礼品说明,t.name=t.礼品名称,t.Term=t.有效期,"未使用"==t.礼品状态&&e.couponlist.push(t)}),0==e.couponlist.length&&(e.CrolssQUan=!1),e.couponlist.forEach(function(e){t.BuyCountNum=parseFloat(t.BuyCountNum)+parseFloat(e.price),console.log(n(e.price," at pages\\function\\Buygasrolls\\Buygasrolls.vue:371"))}),console.log(n(t.BuyCountNum," at pages\\function\\Buygasrolls\\Buygasrolls.vue:373")),console.log(n(e.couponlist," at pages\\function\\Buygasrolls\\Buygasrolls.vue:374"))})},checkchecked:function(){console.log(n(this.BuyMoney," at pages\\function\\Buygasrolls\\Buygasrolls.vue:385")),""!=this.BuyMoney&&null!=this.BuyMoney?parseFloat(this.BuyCountNum)>=parseFloat(this.BuyMoney)?e.showToast({title:"不可以选择此加油券，优惠券总金额已大于充值金额",duration:1e3,icon:"none"}):(this.checkchecke=!this.checkchecke,this.checkchecke):e.showToast({title:"请输入充值金额",duration:1e3,icon:"none"})},touchstart:function(e){e.preventDefault(),this.startX=e.touches[0].pageX},touchmove:function(t){return t.preventDefault(),this.moveEndX=t.touches[0].pageX,this.valueX=this.moveEndX-this.startX,this.valueX>=80?void e.navigateBack({delta:1,animationType:"pop-in",animationDuration:200}):void this.valueX},bindPickerChange:function(e){console.log(n(e.target," at pages\\function\\Buygasrolls\\Buygasrolls.vue:434")),this.pricetext=this.array[e.target.value]+".00",this.col="black"},Settlement:function(){"请登录"!=this.UserInfo.userphone?""==this.BuyMoney||this.BuyMoney<=0?e.showToast({title:"请输入正确的支付数值",duration:1e3,icon:"none"}):(this.GetUserMoney(),this.payone=!0,this.diskif=!0,this.Payamin=!0):e.showToast({title:"您好还没有登录，请先登录再充值",duration:1e3,icon:"none"})},Replacemode:function(){(parseFloat(this.money)<=0||parseFloat(this.money)<parseFloat(this.BuyMoney))&&(this.moneyno=!0),this.payone=!1,this.paytwo=!0},Optionbalance:function(){var e=this;if(console.log(n(parseFloat(this.money)," at pages\\function\\Buygasrolls\\Buygasrolls.vue:476")),console.log(n(parseFloat(this.BuyMoney)," at pages\\function\\Buygasrolls\\Buygasrolls.vue:477")),parseFloat(this.money)<=0||parseFloat(this.money)<parseFloat(this.BuyMoney))return this.Promptinfo="余额不足，请选择微信支付方式进行支付",this.vervisit="block",this.veramin=!0,void setTimeout(function(){e.vervisit="none",e.veramin=!1},1500);this.payone=!0,this.paytwo=!1,this.payreplacetext="账户余额",this.weixinimage=!1,this.balanceimage=!0},weixinoption:function(){this.payone=!0,this.paytwo=!1,this.payreplacetext="微信",this.weixinimage=!0,this.yunshanfuimage=!1,this.balanceimage=!1,this.vervisit="none",this.veramin=!1},Optionyunshangfu:function(){this.payone=!0,this.paytwo=!1,this.payreplacetext="云闪付",this.yunshanfuimage=!0,this.weixinimage=!1,this.balanceimage=!1,this.vervisit="none",this.veramin=!1},backpayone:function(){this.yunshanfuimage=!1,this.payone=!0,this.paytwo=!1,this.vervisit="none",this.veramin=!1},closepay:function(){this.weixinoption(),this.diskif=!1,this.Payamin=!1},closepays:function(){this.weixinoption(),this.diskif=!1,this.Payamin=!1,e.showToast({title:"已取消支付",duration:1e3,icon:"none"})},done:function(t){var o=this,s=this;return"error"==t?(this.alertarray.show=!0,this.alertarray.msg="支付密码不正确",setTimeout(function(){o.alertarray.show=!1},1e3),!1):(this.closepay(),this.$refs.keyboard.hide(),this.$refs.simpleLoading.show({image:"../../../static/app-plus/tus.png",text:"支付中..."}),setTimeout(function(){o.$refs.simpleLoading.hide(),e.showToast({title:"支付成功",duration:1e3,icon:"none",success:function(){s.gasrolls=!s.gasrolls,s.QRcode=!0,s.BuyMoney="",s.CountBuyMoney="",s.checkchecke=!1,s.couponlist.forEach(function(e){e.state=1}),s.Buyindex=0,s.BuyNumber=0,s.Monitoringcode()}})},2e3),console.log(n("支付成功"," at pages\\function\\Buygasrolls\\Buygasrolls.vue:581")),!0)},GetBuy:function(e){if(console.log(n(e," at pages\\function\\Buygasrolls\\Buygasrolls.vue:586")),2==e.state)return this.Buyindex++,this.BuyNumber=parseFloat(this.BuyNumber)+parseFloat(e.money),this.CountBuyMoney=parseFloat(this.CountBuyMoney)-parseFloat(e.money),void console.log(n("aaaaaaaaa"+this.CountBuyMoney," at pages\\function\\Buygasrolls\\Buygasrolls.vue:591"));this.Buyindex--,this.BuyNumber=parseFloat(this.BuyNumber)-parseFloat(e.money),this.CountBuyMoney=parseFloat(this.CountBuyMoney)+parseFloat(e.money)},Changestate:function(){this.CountBuyMoney=this.BuyMoney,this.BuyClear=!this.BuyClear,this.checkchecke=!1,this.couponlist.forEach(function(e){e.state=1}),this.Buyindex=0,this.BuyNumber=0},confirmPwd:function(){if("微信"==this.payreplacetext)return this.payone=!1,this.closepay(),void e.getProvider({service:"payment",success:function(t){console.log(n(t.provider," at pages\\function\\Buygasrolls\\Buygasrolls.vue:617")),~t.provider.indexOf("wxpay")&&e.requestPayment({provider:"wxpay",orderInfo:"orderInfo",success:function(e){console.log(n("success:"+JSON.stringify(e)," at pages\\function\\Buygasrolls\\Buygasrolls.vue:623"))},fail:function(e){console.log(n("fail:"+JSON.stringify(e)," at pages\\function\\Buygasrolls\\Buygasrolls.vue:626"))}})}});if("云闪付"!=this.payreplacetext)this.$refs.keyboard.show(),this.payone=!1,this.closepay();else{var t=e.requireNativePlugin("GZF-YunPay");t.show({title:"685871836444776059921"},function(t){console.log(n(t," at pages\\function\\Buygasrolls\\Buygasrolls.vue:639"));var o=t.type;-1==parseInt(o)?e.showToast({icon:"none",title:"请安装云闪付APP",duration:1e3}):parseInt(o)})}},sliderchange:function(e){this.size=e.detail.value},creatQrcode:function(){this.$refs.qrcode._makeCode()},saveQrcode:function(){this.$refs.qrcode._saveCode()},qrR:function(e){this.src=e},clearQrcode:function(){this.$refs.qrcode._clearCode(),this.val=""},ifQrcode:function(){this.ifShow=!this.ifShow}}};t.default=l}).call(this,o("6e42")["default"],o("0de9")["default"])},fffa:function(e,t,o){"use strict";(function(e){o("b1e6"),o("921b");n(o("66fd"));var t=n(o("88b6"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,o("6e42")["createPage"])}},[["fffa","common/runtime","common/vendor"]]]);