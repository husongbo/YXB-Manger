(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/myindex/Invoiceinfo/Invoiceinfo"],{"1e54":function(t,e,i){"use strict";i.r(e);var a=i("31ac"),n=i.n(a);for(var s in a)"default"!==s&&function(t){i.d(e,t,function(){return a[t]})}(s);e["default"]=n.a},2806:function(t,e,i){"use strict";i.r(e);var a=i("a2b2"),n=i("1e54");for(var s in n)"default"!==s&&function(t){i.d(e,t,function(){return n[t]})}(s);i("5cc8");var o=i("2877"),r=Object(o["a"])(n["default"],a["a"],a["b"],!1,null,null,null);e["default"]=r.exports},"31ac":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={props:{arrlist:{type:Array}},data:function(){return{arrlistes:""}},onLoad:function(){console.log(JSON.stringify(this.arrlist))},methods:{changeradio:function(t,e){console.log(e),t.img=e?"../../../static/app-plus/radio.png":"../../../static/app-plus/circle.png",t.flag=e,this.$emit("clickradio",t,e)},downups:function(t,e){console.log(e),t.imgs=e?"../../../static/app-plus/up.png":"../../../static/app-plus/down.png",t.updown=e,this.$emit("shoubuliao",t,e)}}};e.default=a},"5cc8":function(t,e,i){"use strict";var a=i("95f1"),n=i.n(a);n.a},"6c09":function(t,e,i){},"8db0":function(t,e,i){"use strict";var a=i("6c09"),n=i.n(a);n.a},"95f1":function(t,e,i){},"978b":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view",{staticClass:"parent-info",attrs:{eventid:"0d234eb9-11"},on:{touchstart:t.touchstart,touchmove:t.touchmove}},[i("view",[i("uni-view",{staticClass:"uni-list-cell",attrs:{"data-v-960e14a2":"",mpcomid:"0d234eb9-1"}},[i("uni-view",{staticClass:"uni-list-cell-navigate uni-navigate-right",attrs:{"data-v-960e14a2":"",mpcomid:"0d234eb9-0"}},[t._v("发票类型")])],1),i("uni-view",{staticClass:"uni-list-cell cell-btn",attrs:{"data-v-960e14a2":"",mpcomid:"0d234eb9-2"}},[i("view",{staticClass:"btns",attrs:{"data-v-5c82e918":""}},[t._v("电子普通发票")])])],1),i("view",[i("uni-view",{staticClass:"uni-list-cell",attrs:{"data-v-960e14a2":"",mpcomid:"0d234eb9-4"}},[i("uni-view",{staticClass:"uni-list-cell-navigate uni-navigate-right",attrs:{"data-v-960e14a2":"",mpcomid:"0d234eb9-3"}},[t._v("发票抬头")])],1),i("view",{staticStyle:{width:"100%","overflow-x":"hidden"}},[i("radio-group",{staticClass:"uni-flex",attrs:{name:"gender",eventid:"0d234eb9-0",mpcomid:"0d234eb9-5"},on:{change:t.radiocheck}},[i("label",[i("radio",{attrs:{value:"0",checked:""}}),t._v("个人")],1),i("label",{staticClass:"radio-right"},[i("radio",{attrs:{value:"1"}}),t._v("公司")],1)],1)],1),i("view",{style:{display:t.item}},[i("view",{staticClass:"item-inner"},[i("span",[t._v("添加公司名称和税号")]),i("span",{staticClass:"add",attrs:{eventid:"0d234eb9-1"},on:{click:t.modaladd}},[t._v("+")])]),t.Companyif?i("view",{staticClass:"card"},[i("view",{staticClass:"card-header"},[i("span",[t._v("公司名称")]),i("view",{staticClass:"card-text",staticStyle:{"font-size":".8rem"}},[t._v(t._s(t.Company.name))]),i("picker",{attrs:{value:t.index,range:t.array,eventid:"0d234eb9-2"},on:{change:t.bindPickerChange}},[i("view",{staticStyle:{color:"#CCCCCC"}},[t._v("请选择公司")])])],1),i("view",{staticClass:"card-header"},[i("span",[t._v("税号")]),i("view",{staticClass:"card-text",staticStyle:{"font-size":".8rem"}},[t._v(t._s(t.Company.id))])])]):t._e()]),i("view",{style:{display:t.items}},[i("view",{staticClass:"card"},[i("view",{staticClass:"card-header"},[i("span",[t._v("姓名")]),i("input",{staticStyle:{"font-size":".9rem"},attrs:{type:"text",disabled:"disabled",value:t.UserInfo.userinfos.M0001_NAME,placeholder:"请填写姓名"}})]),i("view",{staticClass:"card-header"},[i("span",[t._v("身份证号")]),i("input",{staticStyle:{"font-size":".9rem"},attrs:{type:"text",disabled:"disabled",value:t.UserInfo.userinfos.M0001_IDENTITY_CARD,placeholder:"填写身份证号"}})]),i("view",{staticClass:"card-header"},[i("span",[t._v("电子邮箱")]),i("input",{staticStyle:{"font-size":".9rem"},attrs:{type:"text",disabled:"disabled",value:t.UserInfo.userinfos.M0001_EMAIL,placeholder:"填写电子邮箱"}})])])]),i("uni-view",{staticClass:"uni-list-cell",attrs:{"data-v-960e14a2":"",mpcomid:"0d234eb9-7"}},t._l(t.tabList,function(e,a){return i("uni-view",{key:a,staticClass:"uni-list-cell-navigate uni-navigate-right",class:[{active:a==t.tabIndex}],attrs:{eventid:"0d234eb9-3-"+a,mpcomid:"0d234eb9-6-"+a},on:{tap:function(e){t.toggleTab(a)}}},[i("span",[t._v("月份选择"),i("span",[t._v("（请选择）")])]),i("span",[t._v(t._s(t.tabList[0].name))])])})),i("arrlists",{attrs:{arrlist:t.arrlist,eventid:"0d234eb9-4",mpcomid:"0d234eb9-8"},on:{clickradio:t.radios,shoubuliao:t.aiaiai}}),i("w-picker",{ref:"picker",attrs:{mode:t.mode,startYear:"2016",endYear:"2030",step:"1",defaultVal:t.defaultVal,themeColor:"#f00",eventid:"0d234eb9-5",mpcomid:"0d234eb9-9"},on:{confirm:t.onConfirm}}),i("view",{staticClass:"btn"},[i("view",{staticClass:"register-ok",attrs:{"data-v-7a1412f1":"","data-v-5c82e918":"",eventid:"0d234eb9-6"},on:{click:t.Invoicesub}},[t._v("提交")])])],1),i("view",{staticClass:"modal-in",class:{"modal-add":t.modals,"modal-hid":t.modalshid},staticStyle:{"margin-top":"-123px"}},[i("view",{staticClass:"modal-inner"},[i("view",{staticClass:"modal-title"},[t._v("添加")]),i("view",{staticClass:"modal-text",staticStyle:{"margin-bottom":"60rpx"}},[i("span",{staticStyle:{width:"30%",display:"flex","align-items":"center"}},[t._v("公司名称")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.Companytext.Name,expression:"Companytext.Name"}],staticClass:"inputs",staticStyle:{"text-align":"left","padding-left":"20rpx",height:"60rpx","line-height":"60rpx","font-size":".9rem"},attrs:{type:"text",placeholder:"请输入公司全称",eventid:"0d234eb9-7"},domProps:{value:t.Companytext.Name},on:{input:function(e){e.target.composing||(t.Companytext.Name=e.target.value)}}})]),i("view",{staticClass:"modal-text",staticStyle:{"margin-bottom":"40rpx"}},[i("span",{staticStyle:{width:"30%",display:"flex","align-items":"center"}},[t._v("识别号")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.Companytext.IDCom,expression:"Companytext.IDCom"}],staticClass:"inputs",staticStyle:{"text-align":"left","padding-left":"20rpx",height:"60rpx","line-height":"60rpx","font-size":".9rem"},attrs:{type:"text",placeholder:"请填写纳税人识别号",eventid:"0d234eb9-8"},domProps:{value:t.Companytext.IDCom},on:{input:function(e){e.target.composing||(t.Companytext.IDCom=e.target.value)}}})])]),i("view",{staticClass:"modal-buttons"},[i("span",{staticClass:"modal-button",attrs:{eventid:"0d234eb9-9"},on:{click:t.closemodal}},[t._v("取消")]),i("span",{staticClass:"modal-button modal-button-bold",attrs:{eventid:"0d234eb9-10"},on:{click:t.Determine}},[t._v("确定")])])]),i("view",{staticClass:"modal-overlay",style:{display:t.dismodal}}),i("alerts",{attrs:{show:t.alertarray.show,msg:t.alertarray.msg,mpcomid:"0d234eb9-10"}}),i("simpleLoading",{ref:"simpleLoading",attrs:{mpcomid:"0d234eb9-11"}})],1)},n=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return n})},a2b2:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view",{},t._l(t.arrlist,function(e,a){return i("view",{key:a},[i("view",{staticClass:"headpages"},[i("view",{staticClass:"headoages-left",staticStyle:{width:"50%",display:"flex","flex-direction":"row",height:"80rpx","align-items":"center"},attrs:{eventid:"32c73640-0-"+a},on:{tap:function(i){t.changeradio(e,!e.flag)}}},[i("image",{staticStyle:{width:"40rpx",height:"40rpx","margin-left":"30rpx"},attrs:{src:e.img,mode:""}}),i("view",{staticStyle:{"margin-left":"20rpx"}},[t._v(t._s(e.months))])]),i("view",{staticStyle:{width:"50%",display:"flex","align-items":"center","justify-content":"flex-end"},attrs:{eventid:"32c73640-1-"+a},on:{tap:function(i){t.downups(e,!e.updown)}}},[i("image",{staticStyle:{width:"40rpx",height:"40rpx","margin-right":"40rpx"},attrs:{src:e.imgs,mode:""}})])]),t._l(e.list,function(a,n){return e.updown?t._e():i("view",{key:n,staticClass:"uni-list-cell",attrs:{"hover-class":"uni-list-cell-hover"}},[i("view",{staticClass:"uni-list-cell-navigate uni-navigate-right uni-media-list "},[t._m(0,!0),i("view",{staticClass:"uni-media-list-body"},[i("view",{staticClass:"uni-media-list-text-top"},[t._v(t._s(a.name))]),i("view",{staticClass:"uni-media-list-text-bottom uni-ellipsis"},[t._v(t._s(a.time))])]),i("view",{staticClass:"money"},[t._v("￥"),i("span",[t._v(t._s(a.price))])])])])})],2)}))},n=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view",{staticClass:"uni-media-list-logo"},[i("image",{attrs:{src:"../../../static/myicon/mx1.png"}})])}];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return n})},a9f1:function(t,e,i){"use strict";i("fa0a");var a=s(i("b0ce")),n=s(i("ca40"));function s(t){return t&&t.__esModule?t:{default:t}}Page((0,a.default)(n.default))},aab3:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=l(i("1f95")),n=l(i("e3ba")),s=l(i("79ee")),o=l(i("2806")),r=i("2f62");function l(t){return t&&t.__esModule?t:{default:t}}function c(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},a=Object.keys(i);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),a.forEach(function(e){d(t,e,i[e])})}return t}function d(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var u={data:function(){return{len:0,startX:0,moveEndX:0,valueX:0,item:"none",items:"block",modals:!1,dismodal:"none",modalshid:!0,array:[],index:1,tabList:[{mode:"yearMonth",name:"",value:[0,1]}],tabIndex:0,Companytext:{Name:"",IDCom:""},Company:{name:"",id:""},CompanyYZ:[{num:/^[a-zA-Z0-9]{15}$/},{num:/^[a-zA-Z0-9]{18}$/},{num:/^[a-zA-Z0-9]{20}$/}],CompanyFlag:!1,alertarray:{show:!1,msg:""},EditIndex:0,Companylist:[],Companyif:!1,ComRecordList:[],checkedlist:[],ceshilist:[],arrlist:[],subindex:0}},components:{wPicker:a.default,alerts:n.default,simpleLoading:s.default,arrlists:o.default},onNavigationBarButtonTap:function(e){t.navigateTo({url:"/pages/myindex/Instructions/Instructions",animationType:"pop-in",animationDuration:200})},computed:c({},(0,r.mapState)(["UserInfo"]),{mode:function(){return this.tabList[this.tabIndex].mode},defaultVal:function(){return this.tabList[this.tabIndex].value}}),onLoad:function(){console.log(this.UserInfo.userid),this.GetInvoiceRecord(),this.GetRecord()},methods:{touchstart:function(t){t.preventDefault(),this.startX=t.touches[0].pageX},bindPickerChange:function(t){var e=this;console.log(t.target.value),this.Companylist.forEach(function(i,a){if(a==t.target.value)return e.Company.name=i.PT0019_COMPANY_NAME,void(e.Company.id=i.PT0019_TAX_NUMBER)})},Invoicesub:function(){var e=this;if(0==e.subindex){if(e.subindex=1,0==e.ComRecordList.length)return t.showToast({title:"您还没有需要提交的发票",duration:1e3,icon:"none"}),void(e.subindex=0);if(0==e.checkedlist.length)return t.showToast({title:"请选择要提交的发票",duration:1e3,icon:"none"}),void(e.subindex=0);var i="";e.checkedlist.forEach(function(t,a){e.checkedlist.length!=a+1?i+=t+",":i+=t});var a='{method:"ApplayTicketInfo",user_id:"'.concat(this.UserInfo.userid,'",month:"').concat(i,'",ticket_type:"1",ticket_info_id:\'\', email:"').concat(this.UserInfo.userinfos.M0001_EMAIL,'"}');this.$api.ReagisterPhone(a).then(function(t){console.log(JSON.stringify(t))}),console.log(a)}},radios:function(t,e){var i=this;console.log(t.months),this.arrlist.forEach(function(a,n){if(a.months==t.months)if(e)i.checkedlist.push(t.months),console.log(JSON.stringify(i.checkedlist));else{if(0==i.checkedlist.length)return;i.checkedlist.forEach(function(e,a){if(t.months==e)return i.checkedlist.splice(a,1),void console.log(JSON.stringify(i.checkedlist))})}})},aiaiai:function(t,e){var i=this;console.log(t.months),this.arrlist.forEach(function(a,n){if(a.months==t.months)if(e)i.ceshilist.push(t.months);else{if(0==i.ceshilist.length)return;i.ceshilist.forEach(function(e,a){t.months!=e||i.ceshilist.splice(a,1)})}})},GetRecord:function(){var t=this,e='{method:"GetTicketInfo",user_id:"'.concat(this.UserInfo.userid,'"}');this.$api.ReagisterPhone(e).then(function(e){if(console.log(JSON.stringify(e)),1==e.data.result)return t.ComRecordList=JSON.parse(e.data.data),t.ComRecordList.forEach(function(t){t.months=t.消费月份,t.name=t.消费商品,t.price=t.消费金额,t.time=t.消费时间}),console.log(JSON.stringify(t.ComRecordList)),t.arrlist.push({months:"",img:"",imgs:"",flag:"",updown:"",list:[]}),t.arrlist[0].months=t.ComRecordList[0].months,t.arrlist[0].img="../../../static/app-plus/circle.png",t.arrlist[0].imgs="../../../static/app-plus/down.png",t.arrlist[0].flag=!1,t.arrlist[0].updown=!1,t.arrlist[0].list=[],t.arrlist[0].list.push(t.ComRecordList[0]),t.ComRecordList.forEach(function(e,i){if(0!=i){var a=0;t.arrlist.forEach(function(i,n){if(console.log(t.arrlist.length),parseInt(i.months)==parseInt(e.months))return a++,i.list.push(e),void console.log(i.months)}),0==a&&(t.arrlist.push({months:"",img:"",imgs:"",flag:"",updown:"",list:[]}),console.log(t.arrlist.length),t.arrlist[t.arrlist.length-1].months=e.months,t.arrlist[t.arrlist.length-1].list.push(e),t.arrlist[t.arrlist.length-1].img="../../../static/app-plus/circle.png",t.arrlist[t.arrlist.length-1].flag=!1,t.arrlist[t.arrlist.length-1].imgs="../../../static/app-plus/down.png",t.arrlist[t.arrlist.length-1].updown=!1),console.log(JSON.stringify(t.arrlist))}}),void console.log(JSON.stringify(t.arrlist))})},GetInvoiceRecord:function(){var t=this,e=this;e.array=[];var i='{method:"GetCompanyTicketInfo",user_id:"'.concat(this.UserInfo.userid,'"}');this.$api.ReagisterPhone(i).then(function(i){0!=i.data.result&&(t.Companylist=JSON.parse(i.data.data),0!=t.Companylist.length&&(t.Companyif=!0),t.Company.name=t.Companylist[0].PT0019_COMPANY_NAME,t.Company.id=t.Companylist[0].PT0019_TAX_NUMBER,t.Companylist.forEach(function(t){e.array.push(t.PT0019_COMPANY_NAME)}),console.log(t.Companylist))})},touchmove:function(e){return e.preventDefault(),this.moveEndX=e.touches[0].pageX,this.valueX=this.moveEndX-this.startX,this.valueX>=80?void t.navigateBack({delta:1,animationType:"pop-in",animationDuration:200}):void this.valueX},radiocheck:function(t){"0"==t.detail.value?(this.items="block",this.item="none"):(this.item="block",this.items="none")},modaladd:function(){this.dismodal="block",this.modalshid=!1,this.modals=!0},closemodal:function(){this.dismodal="none",this.modalshid=!0,this.modals=!1},Determine:function(){var e=this,i=this;if(console.log(this.Companytext.IDCom),0==i.EditIndex){if(i.EditIndex=1,""==i.Companytext.Name||""==i.Companytext.IDCom)return i.alertarray.show=!0,i.alertarray.msg="不能为空，请继续输入",void setTimeout(function(){i.alertarray.show=!1,i.EditIndex=0},1e3);if(this.CompanyYZ.forEach(function(t){t.num.test(i.Companytext.IDCom)&&(i.CompanyFlag=!0)}),console.log(i.CompanyFlag),i.CompanyFlag){var a='{method:"UpdateCompanyTicketInfo",user_id:"'.concat(i.UserInfo.userid,'",company_name:"').concat(i.Companytext.Name,'",tax_number:"').concat(i.Companytext.IDCom,'"}');return void this.$api.ReagisterPhone(a).then(function(a){if(console.log(JSON.stringify(a)),1==a.data.result)return i.$refs.simpleLoading.show({image:"../../../static/app-plus/tus.png",text:"绑定中..."}),void setTimeout(function(){i.$refs.simpleLoading.hide(),i.EditIndex=0,i.Companytext.Name="",i.Companytext.IDCom="",e.dismodal="none",e.modalshid=!0,e.modals=!1,i.GetInvoiceRecord(),t.showToast({title:"绑定成功",duration:1e3,icon:"none"})},1e3);setTimeout(function(){i.$refs.simpleLoading.hide(),i.EditIndex=0,i.Companytext.Name="",i.Companytext.IDCom="",e.dismodal="none",e.modalshid=!0,e.modals=!1,t.showToast({title:"绑定失败",duration:1e3,icon:"none"})},1e3)})}i.alertarray.show=!0,i.alertarray.msg="公司识别号格式不正确，请重新输入",i.Companytext.IDCom="",setTimeout(function(){i.alertarray.show=!1,i.EditIndex=0},1e3)}},toggleTab:function(t){this.tabIndex=t,this.$refs.picker.show()},onConfirm:function(t){console.log(t),this.tabList[0].name=t.result}}};e.default=u}).call(this,i("6e42")["default"])},ca40:function(t,e,i){"use strict";i.r(e);var a=i("978b"),n=i("e0a9");for(var s in n)"default"!==s&&function(t){i.d(e,t,function(){return n[t]})}(s);i("8db0");var o=i("2877"),r=Object(o["a"])(n["default"],a["a"],a["b"],!1,null,"6cf4f016",null);e["default"]=r.exports},e0a9:function(t,e,i){"use strict";i.r(e);var a=i("aab3"),n=i.n(a);for(var s in a)"default"!==s&&function(t){i.d(e,t,function(){return a[t]})}(s);e["default"]=n.a}},[["a9f1","common/runtime","common/vendor"]]]);