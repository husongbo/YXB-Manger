(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/myindex/Invoiceinfo/Invoiceinfo"],{"4e9d":function(n,e,t){"use strict";(function(n){t("b1e6"),t("921b");i(t("66fd"));var e=i(t("7f81"));function i(n){return n&&n.__esModule?n:{default:n}}n(e.default)}).call(this,t("6e42")["createPage"])},"6ddb":function(n,e,t){"use strict";var i=function(){var n=this,e=n.$createElement;n._self._c},o=[];t.d(e,"a",function(){return i}),t.d(e,"b",function(){return o})},"713e":function(n,e,t){"use strict";var i=t("9b8f"),o=t.n(i);o.a},"7f81":function(n,e,t){"use strict";t.r(e);var i=t("6ddb"),o=t("da21");for(var a in o)"default"!==a&&function(n){t.d(e,n,function(){return o[n]})}(a);t("713e");var s=t("2877"),r=Object(s["a"])(o["default"],i["a"],i["b"],!1,null,"d67589ac",null);e["default"]=r.exports},"9b8f":function(n,e,t){},da21:function(n,e,t){"use strict";t.r(e);var i=t("ddf9"),o=t.n(i);for(var a in i)"default"!==a&&function(n){t.d(e,n,function(){return i[n]})}(a);e["default"]=o.a},ddf9:function(n,e,t){"use strict";(function(n,i){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=t("2f62");function a(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},i=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(t).filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),i.forEach(function(e){s(n,e,t[e])})}return n}function s(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var r=function(){return Promise.all([t.e("common/vendor"),t.e("components/w-picker/w-picker")]).then(t.bind(null,"6910"))},c=function(){return t.e("components/loading/alert").then(t.bind(null,"818f"))},l=function(){return t.e("components/loading/dialog-loading").then(t.bind(null,"7213"))},u=function(){return t.e("pages/myindex/Invoiceinfo/list").then(t.bind(null,"a43c"))},d={data:function(){return{len:0,startX:0,moveEndX:0,valueX:0,item:"none",items:"block",modals:!1,dismodal:"none",modalshid:!0,array:[],index:1,tabList:[{mode:"yearMonth",name:"",value:[0,1]}],tabIndex:0,Companytext:{Name:"",IDCom:""},Company:{name:"",id:""},CompanyYZ:[{num:/^[a-zA-Z0-9]{15}$/},{num:/^[a-zA-Z0-9]{18}$/},{num:/^[a-zA-Z0-9]{20}$/}],CompanyFlag:!1,alertarray:{show:!1,msg:""},EditIndex:0,Companylist:[],Companyif:!1,ComRecordList:[],checkedlist:[],ceshilist:[],arrlist:[],subindex:0}},components:{wPicker:r,alerts:c,simpleLoading:l,arrlists:u},onNavigationBarButtonTap:function(e){n.navigateTo({url:"/pages/myindex/Instructions/Instructions",animationType:"pop-in",animationDuration:200})},computed:a({},(0,o.mapState)(["UserInfo"]),{mode:function(){return this.tabList[this.tabIndex].mode},defaultVal:function(){return this.tabList[this.tabIndex].value}}),onLoad:function(){console.log(i(this.UserInfo.userid," at pages\\myindex\\Invoiceinfo\\Invoiceinfo.vue:210")),this.GetInvoiceRecord(),this.GetRecord()},methods:{touchstart:function(n){n.preventDefault(),this.startX=n.touches[0].pageX},bindPickerChange:function(n){var e=this;console.log(i(n.target.value," at pages\\myindex\\Invoiceinfo\\Invoiceinfo.vue:220")),this.Companylist.forEach(function(t,i){if(i==n.target.value)return e.Company.name=t.PT0019_COMPANY_NAME,void(e.Company.id=t.PT0019_TAX_NUMBER)})},Invoicesub:function(){var e=this;if(0==e.subindex){if(e.subindex=1,0==e.ComRecordList.length)return n.showToast({title:"您还没有需要提交的发票",duration:1e3,icon:"none"}),void(e.subindex=0);if(0==e.checkedlist.length)return n.showToast({title:"请选择要提交的发票",duration:1e3,icon:"none"}),void(e.subindex=0);var t="";e.checkedlist.forEach(function(n,i){e.checkedlist.length!=i+1?t+=n+",":t+=n});var o='{method:"ApplayTicketInfo",user_id:"'.concat(this.UserInfo.userid,'",month:"').concat(t,'",ticket_type:"1",ticket_info_id:\'\', email:"').concat(this.UserInfo.userinfos.M0001_EMAIL,'"}');this.$api.ReagisterPhone(o).then(function(n){console.log(i(JSON.stringify(n)," at pages\\myindex\\Invoiceinfo\\Invoiceinfo.vue:262"))}),console.log(i(o," at pages\\myindex\\Invoiceinfo\\Invoiceinfo.vue:264"))}},radios:function(n,e){var t=this;console.log(i(n.months," at pages\\myindex\\Invoiceinfo\\Invoiceinfo.vue:270")),this.arrlist.forEach(function(o,a){if(o.months==n.months)if(e)t.checkedlist.push(n.months),console.log(i(JSON.stringify(t.checkedlist)," at pages\\myindex\\Invoiceinfo\\Invoiceinfo.vue:276"));else{if(0==t.checkedlist.length)return;t.checkedlist.forEach(function(e,o){if(n.months==e)return t.checkedlist.splice(o,1),void console.log(i(JSON.stringify(t.checkedlist)," at pages\\myindex\\Invoiceinfo\\Invoiceinfo.vue:286"))})}})},aiaiai:function(n,e){var t=this;console.log(i(n.months," at pages\\myindex\\Invoiceinfo\\Invoiceinfo.vue:296")),this.arrlist.forEach(function(i,o){if(i.months==n.months)if(e)t.ceshilist.push(n.months);else{if(0==t.ceshilist.length)return;t.ceshilist.forEach(function(e,i){n.months!=e||t.ceshilist.splice(i,1)})}})},GetRecord:function(){var n=this,e='{method:"GetTicketInfo",user_id:"'.concat(this.UserInfo.userid,'"}');this.$api.ReagisterPhone(e).then(function(e){if(console.log(i(JSON.stringify(e)," at pages\\myindex\\Invoiceinfo\\Invoiceinfo.vue:323")),1==e.data.result)return n.ComRecordList=JSON.parse(e.data.data),n.ComRecordList.forEach(function(n){n.months=n.消费月份,n.name=n.消费商品,n.price=n.消费金额,n.time=n.消费时间}),console.log(i(JSON.stringify(n.ComRecordList)," at pages\\myindex\\Invoiceinfo\\Invoiceinfo.vue:333")),n.arrlist.push({months:"",img:"",imgs:"",flag:"",updown:"",list:[]}),n.arrlist[0].months=n.ComRecordList[0].months,n.arrlist[0].img="../../../static/app-plus/circle.png",n.arrlist[0].imgs="../../../static/app-plus/down.png",n.arrlist[0].flag=!1,n.arrlist[0].updown=!1,n.arrlist[0].list=[],n.arrlist[0].list.push(n.ComRecordList[0]),n.ComRecordList.forEach(function(e,t){if(0!=t){var o=0;n.arrlist.forEach(function(t,a){if(console.log(i(n.arrlist.length," at pages\\myindex\\Invoiceinfo\\Invoiceinfo.vue:349")),parseInt(t.months)==parseInt(e.months))return o++,t.list.push(e),void console.log(i(t.months," at pages\\myindex\\Invoiceinfo\\Invoiceinfo.vue:353"))}),0==o&&(n.arrlist.push({months:"",img:"",imgs:"",flag:"",updown:"",list:[]}),console.log(i(n.arrlist.length," at pages\\myindex\\Invoiceinfo\\Invoiceinfo.vue:359")),n.arrlist[n.arrlist.length-1].months=e.months,n.arrlist[n.arrlist.length-1].list.push(e),n.arrlist[n.arrlist.length-1].img="../../../static/app-plus/circle.png",n.arrlist[n.arrlist.length-1].flag=!1,n.arrlist[n.arrlist.length-1].imgs="../../../static/app-plus/down.png",n.arrlist[n.arrlist.length-1].updown=!1),console.log(i(JSON.stringify(n.arrlist)," at pages\\myindex\\Invoiceinfo\\Invoiceinfo.vue:370"))}}),void console.log(i(JSON.stringify(n.arrlist)," at pages\\myindex\\Invoiceinfo\\Invoiceinfo.vue:372"))})},GetInvoiceRecord:function(){var n=this,e=this;e.array=[];var t='{method:"GetCompanyTicketInfo",user_id:"'.concat(this.UserInfo.userid,'"}');this.$api.ReagisterPhone(t).then(function(t){0!=t.data.result&&(n.Companylist=JSON.parse(t.data.data),0!=n.Companylist.length&&(n.Companyif=!0),n.Company.name=n.Companylist[0].PT0019_COMPANY_NAME,n.Company.id=n.Companylist[0].PT0019_TAX_NUMBER,n.Companylist.forEach(function(n){e.array.push(n.PT0019_COMPANY_NAME)}),console.log(i(n.Companylist," at pages\\myindex\\Invoiceinfo\\Invoiceinfo.vue:395")))})},touchmove:function(e){return e.preventDefault(),this.moveEndX=e.touches[0].pageX,this.valueX=this.moveEndX-this.startX,this.valueX>=80?void n.navigateBack({delta:1,animationType:"pop-in",animationDuration:200}):void this.valueX},radiocheck:function(n){"0"==n.detail.value?(this.items="block",this.item="none"):(this.item="block",this.items="none")},modaladd:function(){this.dismodal="block",this.modalshid=!1,this.modals=!0},closemodal:function(){this.dismodal="none",this.modalshid=!0,this.modals=!1},Determine:function(){var e=this,t=this;if(console.log(i(this.Companytext.IDCom," at pages\\myindex\\Invoiceinfo\\Invoiceinfo.vue:442")),0==t.EditIndex){if(t.EditIndex=1,""==t.Companytext.Name||""==t.Companytext.IDCom)return t.alertarray.show=!0,t.alertarray.msg="不能为空，请继续输入",void setTimeout(function(){t.alertarray.show=!1,t.EditIndex=0},1e3);if(this.CompanyYZ.forEach(function(n){n.num.test(t.Companytext.IDCom)&&(t.CompanyFlag=!0)}),console.log(i(t.CompanyFlag," at pages\\myindex\\Invoiceinfo\\Invoiceinfo.vue:460")),t.CompanyFlag){var o='{method:"UpdateCompanyTicketInfo",user_id:"'.concat(t.UserInfo.userid,'",company_name:"').concat(t.Companytext.Name,'",tax_number:"').concat(t.Companytext.IDCom,'"}');return void this.$api.ReagisterPhone(o).then(function(o){if(console.log(i(JSON.stringify(o)," at pages\\myindex\\Invoiceinfo\\Invoiceinfo.vue:464")),1==o.data.result)return t.$refs.simpleLoading.show({image:"../../../static/app-plus/tus.png",text:"绑定中..."}),void setTimeout(function(){t.$refs.simpleLoading.hide(),t.EditIndex=0,t.Companytext.Name="",t.Companytext.IDCom="",e.dismodal="none",e.modalshid=!0,e.modals=!1,t.GetInvoiceRecord(),n.showToast({title:"绑定成功",duration:1e3,icon:"none"})},1e3);setTimeout(function(){t.$refs.simpleLoading.hide(),t.EditIndex=0,t.Companytext.Name="",t.Companytext.IDCom="",e.dismodal="none",e.modalshid=!0,e.modals=!1,n.showToast({title:"绑定失败",duration:1e3,icon:"none"})},1e3)})}t.alertarray.show=!0,t.alertarray.msg="公司识别号格式不正确，请重新输入",t.Companytext.IDCom="",setTimeout(function(){t.alertarray.show=!1,t.EditIndex=0},1e3)}},toggleTab:function(n){this.tabIndex=n,this.$refs.picker.show()},onConfirm:function(n){console.log(i(n," at pages\\myindex\\Invoiceinfo\\Invoiceinfo.vue:526")),this.tabList[0].name=n.result}}};e.default=d}).call(this,t("6e42")["default"],t("0de9")["default"])}},[["4e9d","common/runtime","common/vendor"]]]);