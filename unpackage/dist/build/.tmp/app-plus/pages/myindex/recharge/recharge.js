(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/myindex/recharge/recharge"],{"02ef":function(e,t,n){"use strict";n.r(t);var o=n("6782"),i=n("f252");for(var a in i)"default"!==a&&function(e){n.d(t,e,function(){return i[e]})}(a);n("8acd");var s=n("2877"),r=Object(s["a"])(i["default"],o["a"],o["b"],!1,null,"1732f7f7",null);t["default"]=r.exports},6782:function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement,o=(e._self._c,n("beda")),i=n("beda"),a=e._f("filmoney")(e.CountBuyMoney);e.$mp.data=Object.assign({},{$root:{m0:o,m1:i,f0:a}})},i=[];n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i})},6785:function(e,t,n){"use strict";(function(e,o){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n("2f62"),a=function(){return n.e("components/uni-keyboard").then(n.bind(null,"93d1"))},s=function(){return n.e("components/loading/alert").then(n.bind(null,"818f"))},r=function(){return n.e("components/loading/dialog-loading").then(n.bind(null,"7213"))},c=function(){return Promise.all([n.e("common/vendor"),n.e("components/tki-qrcode/tki-qrcode")]).then(n.bind(null,"8484"))},u=function(){return n.e("components/coolc-coupon/coolc-coupon").then(n.bind(null,"602f"))},h={data:function(){return{len:0,startX:0,moveEndX:0,valueX:0,array:["100","200","500","800","1000"],index:1,col:"#ccc",pricetext:"请选择金额",couponlist:[],checkchecke:!1,vershow:!0,vervisit:"none",Payamin:!1,diskif:!1,payone:!0,paytwo:!1,weixinimage:!0,balanceimage:!1,money:"0.00",Promptinfo:"",payreplacetext:"微信",alertarray:{show:!1,msg:""},BuyMoney:"",CountBuyMoney:"",moneyno:!1,gasrolls:!0,QRcode:!1,val:"",size:400,unit:"upx",background:"white",foreground:"black",pdground:"#32dbc6",icon:"../../../static/login/tus.png",iconsize:40,lv:3,onval:!1,loadMake:!0,src:"",Buyindex:0,BuyNumber:"0.00",BuyCountNum:0,dischecked:!0,radioImg:!1,Settimeout:"",ceshiindex:0,CrolssQUan:!0,BuyClear:!1}},computed:(0,i.mapState)(["UserInfo"]),onLoad:function(){var e=this;e.val="id=2,name=胡松波",this.GetBuyCountMoney()},components:{uniKeyboard:a,alerts:s,simpleLoading:r,tkiQrcode:c,coupon:u},filters:{filmoney:function(e){return""==e&&(e="0.00"),e}},onNavigationBarButtonTap:function(t){e.navigateTo({url:"/pages/function/coderecord/coderecord",animationType:"pop-in",animationDuration:200})},watch:{BuyMoney:function(e,t){this.CountBuyMoney=e,console.log(o(this.CountBuyMoney," at pages\\myindex\\recharge\\recharge.vue:318"))},ceshiindex:function(t,n){var i=this;console.log(o(t," at pages\\myindex\\recharge\\recharge.vue:322")),t>=5&&(clearTimeout(this.Settimeout),setTimeout(function(){e.showToast({title:"二维码已被核销",duration:1e3,icon:"none",success:function(){i.gasrolls=!i.gasrolls,i.QRcode=!i.QRcode}})},1e3))}},methods:{touchstart:function(e){e.preventDefault(),this.startX=e.touches[0].pageX},touchmove:function(t){t.preventDefault(),this.moveEndX=t.touches[0].pageX,this.valueX=this.moveEndX-this.startX,this.valueX>=80&&e.navigateBack({delta:1,animationType:"pop-in",animationDuration:200})},bindPickerChange:function(e){console.log(o(e.target," at pages\\myindex\\recharge\\recharge.vue:357")),this.pricetext=this.array[e.target.value]+".00",this.col="black"},GetUserMoney:function(){var e=this;this.UserInfo.userid="3052109275300000002";var t='{method:"GetUserMoneyInfo",user_id:"'.concat(this.UserInfo.userid,'"}');this.$api.ReagisterPhone(t).then(function(t){if(console.log(o(t," at pages\\myindex\\recharge\\recharge.vue:366")),0!=t.data.result||"暂无用户余额信息"!=t.data.message){if(1==t.data.result){var n=JSON.parse(t.data.data_score)[0];e.money=n.MONEY}}else e.money="0.00"})},Monitoringcode:function(){var e=this;this.Settimeout=setInterval(function(){e.ceshiindex++},1e3)},GetBuyCountMoney:function(){var e=this,t=this,n='{method:"GetUserGift",user_id:"'.concat(this.UserInfo.userid,'"}');this.$api.ReagisterPhone(n).then(function(n){if(console.log(o(n," at pages\\myindex\\recharge\\recharge.vue:389")),0==n.data.result)return console.log(o(n.data.message," at pages\\myindex\\recharge\\recharge.vue:391")),void(t.CrolssQUan=!1);t.CrolssQUan=!0;var i=JSON.parse(n.data.data);e.couponlist=[],i.forEach(function(t){var n=t.使用日期,o=n.slice(0,4),i=n.slice(4,6),a=n.slice(6,8);t.使用日期=o+"/"+i+"/"+a,t.price=t.礼品价格,t.Explain=t.礼品说明,t.name=t.礼品名称,t.Term=t.有效期,"未使用"==t.礼品状态&&e.couponlist.push(t)}),e.couponlist.forEach(function(e){t.BuyCountNum=parseFloat(t.BuyCountNum)+parseFloat(e.price),console.log(o(e.price," at pages\\myindex\\recharge\\recharge.vue:420"))}),console.log(o(t.BuyCountNum," at pages\\myindex\\recharge\\recharge.vue:422")),console.log(o(e.couponlist," at pages\\myindex\\recharge\\recharge.vue:423"))})},checkchecked:function(){console.log(o(this.BuyMoney," at pages\\myindex\\recharge\\recharge.vue:434")),""!=this.BuyMoney&&null!=this.BuyMoney?parseFloat(this.BuyCountNum)>=parseFloat(this.BuyMoney)?e.showToast({title:"不可以选择此加油券，优惠券总金额已大于充值金额",duration:1e3,icon:"none"}):(this.checkchecke=!this.checkchecke,this.checkchecke):e.showToast({title:"请输入充值金额",duration:1e3,icon:"none"})},Settlement:function(){"请登录"!=this.UserInfo.userphone?""==this.BuyMoney||this.BuyMoney<=0?e.showToast({title:"请输入正确的支付数值",duration:1e3,icon:"none"}):(this.GetUserMoney(),this.payone=!0,this.diskif=!0,this.Payamin=!0):e.showToast({title:"您好还没有登录，请先登录再充值",duration:1e3,icon:"none"})},Replacemode:function(){(parseFloat(this.money)<=0||parseFloat(this.money)<parseFloat(this.BuyMoney))&&(this.moneyno=!0),this.payone=!1,this.paytwo=!0},Optionbalance:function(){var e=this;if(console.log(o(parseFloat(this.money)," at pages\\myindex\\recharge\\recharge.vue:497")),console.log(o(parseFloat(this.BuyMoney)," at pages\\myindex\\recharge\\recharge.vue:498")),parseFloat(this.money)<=0||parseFloat(this.money)<parseFloat(this.BuyMoney))return this.Promptinfo="余额不足，请选择微信支付方式进行支付",this.vervisit="block",this.veramin=!0,void setTimeout(function(){e.vervisit="none",e.veramin=!1},1500);this.payone=!0,this.paytwo=!1,this.payreplacetext="账户余额",this.weixinimage=!1,this.balanceimage=!0},weixinoption:function(){this.payone=!0,this.paytwo=!1,this.payreplacetext="微信",this.weixinimage=!0,this.balanceimage=!1,this.vervisit="none",this.veramin=!1},backpayone:function(){this.payone=!0,this.paytwo=!1,this.vervisit="none",this.veramin=!1},closepay:function(){this.weixinoption(),this.diskif=!1,this.Payamin=!1},done:function(t){var n=this,i=this;return"error"==t?(this.alertarray.show=!0,this.alertarray.msg="支付密码不正确",setTimeout(function(){n.alertarray.show=!1},1e3),!1):(this.closepay(),this.$refs.keyboard.hide(),this.$refs.simpleLoading.show({image:"../../../static/app-plus/tus.png",text:"支付中..."}),setTimeout(function(){n.$refs.simpleLoading.hide(),e.showToast({title:"支付成功",duration:1e3,icon:"none",success:function(){i.gasrolls=!i.gasrolls,i.QRcode=!0,i.BuyMoney="",i.CountBuyMoney="",i.checkchecke=!1,i.couponlist.forEach(function(e){e.state=1}),i.Buyindex=0,i.BuyNumber=0,i.Monitoringcode()}})},2e3),console.log(o("支付成功"," at pages\\myindex\\recharge\\recharge.vue:581")),!0)},GetBuy:function(e){if(console.log(o(e," at pages\\myindex\\recharge\\recharge.vue:586")),2==e.state)return this.Buyindex++,this.BuyNumber=parseFloat(this.BuyNumber)+parseFloat(e.money),this.CountBuyMoney=parseFloat(this.CountBuyMoney)-parseFloat(e.money),void console.log(o("aaaaaaaaa"+this.CountBuyMoney," at pages\\myindex\\recharge\\recharge.vue:591"));this.Buyindex--,this.BuyNumber=parseFloat(this.BuyNumber)-parseFloat(e.money),this.CountBuyMoney=parseFloat(this.CountBuyMoney)+parseFloat(e.money)},Changestate:function(){this.CountBuyMoney=this.BuyMoney,this.BuyClear=!this.BuyClear,this.checkchecke=!1,this.couponlist.forEach(function(e){e.state=1}),this.Buyindex=0,this.BuyNumber=0},confirmPwd:function(){if("微信"==this.payreplacetext)return this.payone=!1,this.closepay(),void e.getProvider({service:"payment",success:function(t){console.log(o(t.provider," at pages\\myindex\\recharge\\recharge.vue:617")),~t.provider.indexOf("wxpay")&&e.requestPayment({provider:"wxpay",orderInfo:"orderInfo",success:function(e){console.log(o("success:"+JSON.stringify(e)," at pages\\myindex\\recharge\\recharge.vue:623"))},fail:function(e){console.log(o("fail:"+JSON.stringify(e)," at pages\\myindex\\recharge\\recharge.vue:626"))}})}});this.$refs.keyboard.show(),this.payone=!1,this.closepay()},sliderchange:function(e){this.size=e.detail.value},creatQrcode:function(){this.$refs.qrcode._makeCode()},saveQrcode:function(){this.$refs.qrcode._saveCode()},qrR:function(e){this.src=e},clearQrcode:function(){this.$refs.qrcode._clearCode(),this.val=""},ifQrcode:function(){this.ifShow=!this.ifShow}}};t.default=h}).call(this,n("6e42")["default"],n("0de9")["default"])},7084:function(e,t,n){"use strict";(function(e){n("b1e6"),n("921b");o(n("66fd"));var t=o(n("02ef"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("6e42")["createPage"])},"8acd":function(e,t,n){"use strict";var o=n("c202"),i=n.n(o);i.a},c202:function(e,t,n){},f252:function(e,t,n){"use strict";n.r(t);var o=n("6785"),i=n.n(o);for(var a in o)"default"!==a&&function(e){n.d(t,e,function(){return o[e]})}(a);t["default"]=i.a}},[["7084","common/runtime","common/vendor"]]]);