(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/myindex/Paymentpassword/Paymentpassword"],{"0f11":function(t,s,e){"use strict";e("fa0a");var n=a(e("b0ce")),i=a(e("7106"));function a(t){return t&&t.__esModule?t:{default:t}}Page((0,n.default)(i.default))},"25c9":function(t,s,e){"use strict";e.r(s);var n=e("664d"),i=e("6b3d");for(var a in i)"default"!==a&&function(t){e.d(s,t,function(){return i[t]})}(a);e("cbbd");var o=e("2877"),r=Object(o["a"])(i["default"],n["a"],n["b"],!1,null,"1bcfba28",null);s["default"]=r.exports},"25f4":function(t,s,e){},"5aa4":function(t,s,e){"use strict";(function(t){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var n=d(e("ad0f")),i=d(e("6fce")),a=d(e("6815")),o=e("2f62"),r=d(e("79ee"));function d(t){return t&&t.__esModule?t:{default:t}}function c(t){for(var s=1;s<arguments.length;s++){var e=null!=arguments[s]?arguments[s]:{},n=Object.keys(e);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(e).filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.forEach(function(s){l(t,s,e[s])})}return t}function l(t,s,e){return s in t?Object.defineProperty(t,s,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[s]=e,t}var u=function(){var t=[0,1,2,3,4,5,6,7,8,9];return t.sort(function(){return Math.random()>.5?-1:1})},p={props:{defaultPassword:{type:String},flag:{type:Boolean}},components:{uniIcon:a.default,simpleLoading:r.default},data:function(){return{items:[0,1,2,3,4,5],password:[],passwords:[],oldpassword:[],psdString:"",psdStrings:"",oldpsdString:"",keys:u(),pattern:"hidden",oldpsd:!0,newpsd:!1,newpsds:!1,passwordtext:"请输入旧密码",vershow:!0,vervisit:"none",vertext:"俩次密码不一致，请重新输入！",Userid:"",Psdindex:0,userinfo:"",PsdFalg:!0}},computed:(0,o.mapState)(["UserInfo"]),mounted:function(){var t=this,s='{method:"CheckUserPayPwd",user_id:"'.concat(this.UserInfo.userid,'"}');console.log(s),this.$api.ReagisterPhone(s).then(function(s){console.log(s),console.log(s.data.result),1==parseInt(s.data.result)&&"支付密码未设置"==s.data.message?(t.oldpsd=!1,t.newpsd=!0,t.passwordtext="请输入密码",t.PsdFalg=!1):t.PsdFalg=!0})},methods:c({},(0,o.mapMutations)(["SetPayPsd"]),{show:function(){var t={cancel:!1};this.$emit("shown",t),t.cancel||(this.pattern="slideup")},hide:function(){var t={cancel:!1};this.$emit("hidden",t),t.cancel||(this.pattern="slidedown")},AjaxUserInfo:function(){var t=this;console.log(this.UserInfo.userid);var s='{method:"GetUserInfo",user_id:"'.concat(this.UserInfo.userid,'"}');this.$api.ReagisterPhone(s).then(function(s){console.log(JSON.stringify(s)),t.userinfo=JSON.parse(s.data.user_info)[0],t.SetPayPsd(t.userinfo)})},input:function(s){var e=this,a=this,o={target:this,data:s,cancel:!1,callback:void 0};if(console.log("s"),this.$emit("input",o),this.oldpsd)return this.oldpassword.push(s),void(this.oldpassword.length===this.items.length&&(this.oldpsdString=this.oldpassword.join(""),console.log("旧密码"+this.oldpsdString),setTimeout(function(){e.newpsd=!0,e.oldpsd=!1,e.newpsds=!1,e.passwordtext="请输入新密码"},500)));if(this.newpsd)o.cancel||(this.password.push(s),this.password.length===this.items.length&&(this.psdString=this.password.join(""),console.log("第一次"+this.psdString),setTimeout(function(){e.newpsd=!1,e.oldpsd=!1,e.newpsds=!0,e.passwordtext="请再次输入密码"},200)),o.callback&&"function"===typeof o.callback&&o.callback.call(this));else if(this.newpsds&&(this.passwords.push(s),this.passwords.length===this.items.length)){if(this.psdStrings=this.passwords.join(""),this.psdStrings==this.psdString){if(console.log("密码一致"),0==this.Psdindex){if(this.$refs.simpleLoading.show({image:"../../../static/app-plus/tus.png",text:"绑定中..."}),this.Psdindex=1,this.Userid=this.UserInfo.userid,console.log(this.Userid),this.PsdFalg){var r={old_pay_pwd:this.oldpsdString,new_pay_pwd:this.psdStrings};console.log(r);var d=(0,n.default)(this.oldpsdString);console.log(d);var c=i.default.encrypt(JSON.stringify(r),d),l='{method:"ModifyUserPayPwd",user_id:"'.concat(this.Userid,'",post_params:"').concat(c,'"}');return void this.$api.ReagisterPhone(l).then(function(s){console.log(s),setTimeout(function(){a.$refs.simpleLoading.hide(),0==s.data.result?t.showToast({title:s.data.message,duration:1e3,icon:"none",success:function(){a.newpsd=!1,a.oldpsd=!0,a.newpsds=!1,a.passwordtext="请输入旧密码",a.password=[],a.passwords=[],a.oldpassword=[]}}):1==s.data.result&&t.showToast({title:s.data.message,duration:1e3,icon:"none",success:function(){a.newpsd=!1,a.oldpsd=!0,a.newpsds=!1,a.passwordtext="请输入旧密码",a.password=[],a.passwords=[],a.oldpassword=[],setTimeout(function(){t.navigateBack({delta:1,animationType:"pop-out",animationDuration:200})},500)}}),a.Psdindex=0},1e3)})}var u={user_id:this.Userid,user_pay_pwd:this.psdStrings};console.log(u);var p=i.default.encrypt(JSON.stringify(u),"afd60b4ad2ec1l2c586e2150770f8f9e");console.log(p);var h='{method:"SetUserPayPwd",post_params:"'.concat(p,'"}');t.request({url:"http://192.168.1.6:2001/App/Common/CSharp/app/user/UserInfo.ashx",data:{params:h},success:function(s){console.log(s),1==s.data.result&&setTimeout(function(){a.$refs.simpleLoading.hide(),t.showToast({title:"绑定成功",duration:1500,icon:"none",success:function(){a.AjaxUserInfo()}}),setTimeout(function(){e.Psdindex=0,t.navigateBack({delta:1,animationType:"pop-out",animationDuration:200})},1e3)},1e3)}}),this.done()}}else this.vervisit="block",this.passwordtext="请输入密码",this.newpsd=!0,this.newpsds=!1,this.password=[],this.passwords=[],setTimeout(function(){e.vervisit="none"},2e3);console.log(this.psdStrings)}},del:function(){var t={cancel:!1};this.$emit("delete",t),t.cancel||(this.password.length>0&&this.newpsd?this.password=this.password.slice(0,this.password.length-1):this.passwords.length>0&&this.newpsds?this.passwords=this.passwords.slice(0,this.passwords.length-1):this.oldpassword=this.oldpassword.slice(0,this.oldpassword.length-1))},done:function(){this.password.length===this.items.length&&this.$emit("confirm",{target:this,value:this.password.join("")})},Back:function(){t.navigateBack({delta:1,animationType:"pop-out",animationDuration:200})}}),watch:{defaultPassword:{immediate:!0,handler:function(t){t&&6===t.length&&(this.password=t.split("").map(Number))}}}};s.default=p}).call(this,e("6e42")["default"])},"619a":function(t,s,e){"use strict";(function(t){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var n=r(e("25c9")),i=r(e("6815")),a=r(e("8ccb")),o=e("2f62");function r(t){return t&&t.__esModule?t:{default:t}}var d={components:{uniPassword:n.default,uniIcon:i.default,uniKeyboard:a.default},data:function(){return{tabCurrentIndex:0,swiperCurrentIndex:0,titleShowId:"tabTag-0",tabHeight:300,showKeyboard:!1,password:"",psdtext:"请设置6位数的支付密码",UserPsdFlag:!1,len:0,startX:0,moveEndX:0,valueX:0}},computed:(0,o.mapState)(["UserInfo"]),mounted:function(){},methods:{done:function(t){console.log(t),console.log(this.$refs)},confirmPwd:function(){this.$refs.keyboard.show()},onInput:function(t){},onConfirm:function(t){this.password=t.value,console.log(this.password)},tabChange:function(t){var s=t.target.id.replace("tabTag-","");this.swiperCurrentIndex=s,this.tabCurrentIndex=s,this.titleShowId="tabTag-"+s},swiperChange:function(t){var s=t.detail.current;this.tabCurrentIndex=s,this.titleShowId="tabTag-"+s},touchstart:function(t){t.preventDefault(),this.startX=t.touches[0].pageX},touchmove:function(s){s.preventDefault(),this.moveEndX=s.touches[0].pageX,this.valueX=this.moveEndX-this.startX,this.valueX>=80&&t.navigateBack({delta:1,animationType:"pop-in",animationDuration:200})}},onReady:function(){var s=this;t.getSystemInfo({success:function(e){var n=e.windowHeight,i=t.createSelectorQuery().select("#tab-title");i.fields({size:!0},function(t){t&&(s.tabHeight=n-t.height,console.log(s.tabHeight))}).exec()}})}};s.default=d}).call(this,e("6e42")["default"])},"664d":function(t,s,e){"use strict";var n=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("view",{staticClass:"box"},[e("view",{staticClass:"box__header"},[t._t("default",null,{mpcomid:"29770730-0"})],2),e("view",{staticClass:"box__body"},[e("view",{staticClass:"password-box"},[t.oldpsd?e("view",{staticClass:"password-item aa",attrs:{eventid:"29770730-0"},on:{tap:t.show}},t._l(t.items,function(s,n){return e("view",{key:s,staticClass:"password-item-char"},[t.oldpassword[s]||0===t.oldpassword[s]?e("view",{staticClass:"password-item-char__dot"}):t._e()])})):t._e(),t.newpsd?e("view",{staticClass:"password-item",attrs:{eventid:"29770730-1"},on:{tap:t.show}},t._l(t.items,function(s,n){return e("view",{key:s,staticClass:"password-item-char"},[t.password[s]||0===t.password[s]?e("view",{staticClass:"password-item-char__dot"}):t._e()])})):t._e(),t.newpsds?e("view",{staticClass:"password-item",attrs:{eventid:"29770730-2"},on:{tap:t.show}},t._l(t.items,function(s,n){return e("view",{key:s,staticClass:"password-item-char"},[t.passwords[s]||0===t.passwords[s]?e("view",{staticClass:"password-item-char__dot"}):t._e()])})):t._e()]),e("view",{staticStyle:{color:"#CCCCCC","margin-top":"20rpx"}},[t._v(t._s(t.passwordtext))])]),e("view",{class:"keyboard "+t.pattern},[e("ul",{staticClass:"number"},[t._l(t.keys,function(s,n){return e("li",{key:s,staticClass:"button",attrs:{eventid:"29770730-3-"+n},on:{tap:function(e){t.input(s)}}},[t._v(t._s(s))])}),e("li",{staticClass:"button"},[t._v(".")]),e("li",{staticClass:"button down",attrs:{eventid:"29770730-4"},on:{tap:t.hide}})],2),e("view",{staticClass:"action"},[e("view",{staticClass:"delete",attrs:{eventid:"29770730-5"},on:{tap:t.del}}),e("view",{staticClass:"ok",attrs:{eventid:"29770730-6"},on:{click:t.Back}})])],1),e("view",{staticClass:"Verification",class:{veramin:t.vershow},style:{display:t.vervisit}},[t._v(t._s(t.vertext))]),e("button",{staticClass:"Submission",attrs:{type:"primary"}},[t._v("确定")]),e("simpleLoading",{ref:"simpleLoading",attrs:{mpcomid:"29770730-1"}})],1)},i=[];e.d(s,"a",function(){return n}),e.d(s,"b",function(){return i})},"6b3d":function(t,s,e){"use strict";e.r(s);var n=e("5aa4"),i=e.n(n);for(var a in n)"default"!==a&&function(t){e.d(s,t,function(){return n[t]})}(a);s["default"]=i.a},"701c":function(t,s,e){},7106:function(t,s,e){"use strict";e.r(s);var n=e("a084"),i=e("a93c");for(var a in i)"default"!==a&&function(t){e.d(s,t,function(){return i[t]})}(a);e("c757");var o=e("2877"),r=Object(o["a"])(i["default"],n["a"],n["b"],!1,null,null,null);s["default"]=r.exports},a084:function(t,s,e){"use strict";var n=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("view",{staticStyle:{overflow:"hidden",background:"white",height:"100vh"},attrs:{eventid:"28d89576-1"},on:{touchstart:t.touchstart,touchmove:t.touchmove}},[e("view",{attrs:{"data-scindex":"0"}},[e("view",{staticClass:"content"},[e("uni-password",{ref:"secrity",attrs:{flag:t.UserPsdFlag,eventid:"28d89576-0",mpcomid:"28d89576-0"},on:{input:t.onInput,confirm:t.onConfirm}},[t._v(t._s(t.psdtext))])],1)])])},i=[];e.d(s,"a",function(){return n}),e.d(s,"b",function(){return i})},a93c:function(t,s,e){"use strict";e.r(s);var n=e("619a"),i=e.n(n);for(var a in n)"default"!==a&&function(t){e.d(s,t,function(){return n[t]})}(a);s["default"]=i.a},c757:function(t,s,e){"use strict";var n=e("701c"),i=e.n(n);i.a},cbbd:function(t,s,e){"use strict";var n=e("25f4"),i=e.n(n);i.a}},[["0f11","common/runtime","common/vendor"]]]);