(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/Coupon/Coupon"],{"13f4":function(t,e,i){},"63db":function(t,e,i){"use strict";var n=i("13f4"),a=i.n(n);a.a},"88b3":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view",{staticClass:"uni-tab-bar"},[i("scroll-view",{staticClass:"uni-swiper-tab",attrs:{id:"tab-bar","scroll-x":"","scroll-left":t.scrollLeft}},t._l(t.tabBars,function(e,n){return i("view",{key:e.id,class:["swiper-tab-list",t.tabIndex==n?"active":""],attrs:{id:e.id,"data-current":n,eventid:"bf81c626-0-"+n},on:{click:function(e){t.tapTab(n)}}},[t._v(t._s(e.name))])})),i("swiper",{staticClass:"swiper-box",attrs:{current:t.tabIndex,duration:"300",eventid:"bf81c626-3"},on:{change:t.changeTab}},t._l(t.newsitems,function(e,n){return i("swiper-item",{key:n,attrs:{mpcomid:"bf81c626-0-"+n}},[i("scroll-view",{staticClass:"list",attrs:{"scroll-y":"",eventid:"bf81c626-2-"+n},on:{scrolltolower:function(e){t.loadMore(n)}}},[t._l(e.arrlist,function(a,s){return 0!=e.arrlist?i("view",{key:s,staticClass:"coupon-count"},[i("image",{staticStyle:{height:"200rpx",position:"relative"},attrs:{src:a.img,mode:""}}),i("view",{staticClass:"coupon-left"},[i("view",{},[t._v("礼品价格")]),i("view",{staticStyle:{"font-size":"1.2rem"}},[t._v("￥"+t._s(a.price))])]),i("view",{staticClass:"coupon-right"},[i("view",{staticStyle:{color:"black","margin-left":"10rpx","margin-top":"20rpx","font-size":"0.8rem","font-weight":"bold"}},[t._v(t._s(a.name)+"("+t._s(a.Explain)+")")]),i("view",{staticStyle:{width:"100%",float:"left",clear:"both"}},[i("view",{staticStyle:{width:"60%",float:"left"}},[i("view",{staticStyle:{color:"#666","margin-left":"10rpx","margin-top":"20rpx"}},[t._v("有效期:"+t._s(a.Term))])]),0==e.id?i("view",{staticStyle:{width:"40%",float:"right"},attrs:{eventid:"bf81c626-1-"+n+"-"+s},on:{click:function(e){t.Receive(a)}}},[i("image",{staticStyle:{width:"120rpx",height:"50rpx","margin-left":"20rpx"},attrs:{src:"../../../static/app-plus/img_lingqu.png",mode:""}})]):t._e(),1==e.id?i("view",{staticStyle:{width:"40%",float:"right"}},[i("image",{staticStyle:{width:"120rpx",height:"50rpx","margin-left":"20rpx"},attrs:{src:"../../../static/app-plus/img_shiyong.png",mode:""}})]):t._e()]),i("view",{staticStyle:{color:"#999","margin-left":"10rpx","margin-top":"16rpx",width:"100%",float:"left",clear:"both"}},[t._v("支付时抵扣")])])]):t._e()}),0==e.arrlist?i("view",{staticStyle:{display:"flex","justify-content":"center",height:"100%","padding-top":"30%","font-size":"1.2rem",color:"#CCCCCC"}},[t._v("暂时还没有优惠券")]):t._e()],2)],1)})),i("simpleLoading",{ref:"simpleLoading",attrs:{mpcomid:"bf81c626-1"}}),i("simpleDialog",{ref:"simpleDialog2",attrs:{title:t.sDialog.title,message:t.sDialog.message,confirmButtonText:t.sDialog.openbtn,eventid:"bf81c626-4",mpcomid:"bf81c626-2"},on:{confirmButton:t.confirmButton,cancelButton:t.cancelButton}})],1)},a=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return a})},"989b":function(t,e,i){"use strict";i.r(e);var n=i("ae9b"),a=i.n(n);for(var s in n)"default"!==s&&function(t){i.d(e,t,function(){return n[t]})}(s);e["default"]=a.a},ac5c:function(t,e,i){"use strict";i("fa0a");var n=s(i("b0ce")),a=s(i("efe3"));function s(t){return t&&t.__esModule?t:{default:t}}Page((0,n.default)(a.default))},ae9b:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(i("a34a")),a=i("2f62"),s=r(i("b972")),o=r(i("79ee"));function r(t){return t&&t.__esModule?t:{default:t}}function c(t,e,i,n,a,s,o){try{var r=t[s](o),c=r.value}catch(l){return void i(l)}r.done?e(c):Promise.resolve(c).then(n,a)}function l(t){return function(){var e=this,i=arguments;return new Promise(function(n,a){var s=t.apply(e,i);function o(t){c(s,n,a,o,r,"next",t)}function r(t){c(s,n,a,o,r,"throw",t)}o(void 0)})}}var u={computed:(0,a.mapState)(["UserInfo"]),components:{simpleDialog:s.default,simpleLoading:o.default},data:function(){return{scrollLeft:0,isClickChange:!1,tabIndex:0,newsitems:[{id:0,arrlist:[]},{id:1,arrlist:[]},{id:2,arrlist:[]}],sDialog:{message:"是否领取加油券",openbtn:"确定"},tabBars:[{name:"未领取",id:0},{name:"未使用",id:1},{name:"已使用",id:2}],couponitem:""}},onLoad:function(){console.log(this.UserInfo.userid),this.GetCoupon()},methods:{goDetail:function(e){t.navigateTo({url:"/pages/template/tabbar/detail/detail?data="+e.title})},Receive:function(t){console.log(t),this.couponitem=t,this.$refs.simpleDialog2.confirm({title:"提示",message:this.sDialog.message})},confirmButton:function(){var e=this,i='{method:"ReceiveGift",gift_id:"'.concat(this.couponitem.礼品标识,'"}');console.log(i),this.$api.ReagisterPhone(i).then(function(i){e.$refs.simpleLoading.show({image:"../../../static/app-plus/tus.png",text:"领取中，请稍后..."}),setTimeout(function(){e.newsitems.forEach(function(t){t.arrlist=[]}),e.$refs.simpleLoading.hide(),e.GetCoupon(),t.showToast({title:"领取成功",duration:1e3,icon:"none"})},1e3)})},cancelButton:function(){console.log("Dialog 取消按钮点击")},GetCoupon:function(){var e=this,i='{method:"GetUserGift",user_id:"'.concat(this.UserInfo.userid,'"}');this.$api.ReagisterPhone(i).then(function(i){if(console.log(i),0==i.data.result)return console.log(i.data.message),void t.showToast({title:"当前您还没有优惠券",duration:1e3,icon:"none"});var n=JSON.parse(i.data.data);n.forEach(function(t){var i=t.使用日期,n=i.slice(0,4),a=i.slice(4,6),s=i.slice(6,8);t.使用日期=n+"/"+a+"/"+s,t.price=t.礼品价格,t.Explain=t.礼品说明,t.name=t.礼品名称,t.Term=t.有效期,"未领取"==t.礼品状态&&(t.img="../../../static/app-plus/img_lijilingqu_quan.png",e.newsitems[0].arrlist.push(t)),"未使用"==t.礼品状态&&(t.img="../../../static/app-plus/img_lijilingqu_quan.png",e.newsitems[1].arrlist.push(t)),"已使用"==t.礼品状态&&(t.img="../../../static/app-plus/img_yishiyong_bg.png",e.newsitems[2].arrlist.push(t))})})},close:function(e,i){var n=this;t.showModal({content:"是否删除本条信息？",success:function(t){t.confirm&&n.newsitems[e].data.splice(i,1)}})},loadMore:function(t){var e=this;this.newsitems[t].loadingType=1,setTimeout(function(){e.addData(t)},1200)},addData:function(t){if(this.newsitems[t].data.length>30)this.newsitems[t].loadingType=2;else{for(var e=1;e<=10;e++)this.newsitems[t].data.push(this["data"+Math.floor(5*Math.random())]);this.newsitems[t].loadingType=1}},changeTab:function(){var t=l(n.default.mark(function t(e){var i;return n.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(i=e.detail.current,console.log(i),this.isClickChange){t.next=6;break}return this.tabIndex=i,this.isClickChange=!1,t.abrupt("return");case 6:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),getElSize:function(e){return new Promise(function(i,n){t.createSelectorQuery().select("#"+e).fields({size:!0,scrollOffset:!0},function(t){i(t)}).exec()})},tapTab:function(){var t=l(n.default.mark(function t(e){var i,a;return n.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.tabIndex!==e){t.next=4;break}return t.abrupt("return",!1);case 4:return t.next=6,this.getElSize("tab-bar");case 6:i=t.sent,a=i.scrollLeft,this.scrollLeft=a,this.isClickChange=!1,this.tabIndex=e;case 11:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),randomfn:function(){for(var t=[],e=0,i=this.tabBars.length;e<i;e++){for(var n={loadingType:e,data:[]},a=1;a<=10;a++)n.data.push(this["data"+Math.floor(5*Math.random())]);t.push(n)}return t}}};e.default=u}).call(this,i("6e42")["default"])},efe3:function(t,e,i){"use strict";i.r(e);var n=i("88b3"),a=i("989b");for(var s in a)"default"!==s&&function(t){i.d(e,t,function(){return a[t]})}(s);i("63db");var o=i("2877"),r=Object(o["a"])(a["default"],n["a"],n["b"],!1,null,"dafc0ca0",null);e["default"]=r.exports}},[["ac5c","common/runtime","common/vendor"]]]);